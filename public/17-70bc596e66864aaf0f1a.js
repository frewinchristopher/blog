(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{148:function(t,e,i){"use strict";var n=i(9);e.__esModule=!0,e.withPrefix=f,e.navigateTo=e.replace=e.push=e.navigate=e.default=void 0;var r=n(i(158)),s=n(i(159)),o=n(i(7)),a=n(i(48)),l=n(i(49)),h=n(i(4)),u=n(i(0)),c=i(16),d=i(152);function f(t){return function(t){return t.replace(/\/+/g,"/")}("/"+t)}var p={activeClassName:h.default.string,activeStyle:h.default.object},g=function(t){function e(e){var i;i=t.call(this)||this,(0,l.default)((0,a.default)((0,a.default)(i)),"defaultGetProps",function(t){return t.isCurrent?{className:[i.props.className,i.props.activeClassName].filter(Boolean).join(" "),style:(0,s.default)({},i.props.style,i.props.activeStyle)}:null});var n=!1;return"undefined"!=typeof window&&window.IntersectionObserver&&(n=!0),i.state={IOSupported:n},i.handleRef=i.handleRef.bind((0,a.default)((0,a.default)(i))),i}(0,o.default)(e,t);var i=e.prototype;return i.componentDidUpdate=function(t,e){this.props.to===t.to||this.state.IOSupported||___loader.enqueue((0,d.parsePath)(this.props.to).pathname)},i.componentDidMount=function(){this.state.IOSupported||___loader.enqueue((0,d.parsePath)(this.props.to).pathname)},i.handleRef=function(t){var e,i,n,r=this;this.props.innerRef&&this.props.innerRef(t),this.state.IOSupported&&t&&(e=t,i=function(){___loader.enqueue((0,d.parsePath)(r.props.to).pathname)},(n=new window.IntersectionObserver(function(t){t.forEach(function(t){e===t.target&&(t.isIntersecting||t.intersectionRatio>0)&&(n.unobserve(e),n.disconnect(),i())})})).observe(e))},i.render=function(){var t=this,e=this.props,i=e.to,n=e.getProps,o=void 0===n?this.defaultGetProps:n,a=e.onClick,l=e.onMouseEnter,h=(e.activeClassName,e.activeStyle,e.ref,e.innerRef,e.state),p=e.replace,g=(0,r.default)(e,["to","getProps","onClick","onMouseEnter","activeClassName","activeStyle","ref","innerRef","state","replace"]),m=f(i);return u.default.createElement(c.Link,(0,s.default)({to:m,state:h,getProps:o,innerRef:this.handleRef,onMouseEnter:function(t){l&&l(t),___loader.hovering((0,d.parsePath)(i).pathname)},onClick:function(e){return a&&a(e),0!==e.button||t.props.target||e.defaultPrevented||e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||(e.preventDefault(),_(i,{state:h,replace:p})),!0}},g))},e}(u.default.Component);g.propTypes=(0,s.default)({},p,{innerRef:h.default.func,onClick:h.default.func,to:h.default.string.isRequired,replace:h.default.bool});var m=g;e.default=m;var _=function(t,e){window.___navigate(f(t),e)};e.navigate=_;var y=function(t){console.warn('The "push" method is now deprecated and will be removed in Gatsby v3. Please use "navigate" instead.'),window.___push(f(t))};e.push=y;e.replace=function(t){console.warn('The "replace" method is now deprecated and will be removed in Gatsby v3. Please use "navigate" instead.'),window.___replace(f(t))};e.navigateTo=function(t){return console.warn('The "navigateTo" method is now deprecated and will be removed in Gatsby v3. Please use "navigate" instead.'),y(t)}},154:function(t,e,i){var n=i(6);n(n.P,"Function",{bind:i(161)})},158:function(t,e){t.exports=function(t,e){if(null==t)return{};var i,n,r={},s=Object.keys(t);for(n=0;n<s.length;n++)i=s[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}},159:function(t,e){function i(){return t.exports=i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},i.apply(this,arguments)}t.exports=i},161:function(t,e,i){"use strict";var n=i(17),r=i(11),s=i(75),o=[].slice,a={};t.exports=Function.bind||function(t){var e=n(this),i=o.call(arguments,1),l=function(){var n=i.concat(o.call(arguments));return this instanceof l?function(t,e,i){if(!(e in a)){for(var n=[],r=0;r<e;r++)n[r]="a["+r+"]";a[e]=Function("F,a","return new F("+n.join(",")+")")}return a[e](t,i)}(e,n.length,n):s(e,n,t)};return r(e.prototype)&&(l.prototype=e.prototype),l}},168:function(t,e,i){var n=i(223)(Object,"create");t.exports=n},169:function(t,e,i){var n=i(605);t.exports=function(t,e){for(var i=t.length;i--;)if(n(t[i][0],e))return i;return-1}},170:function(t,e,i){var n=i(611);t.exports=function(t,e){var i=t.__data__;return n(e)?i["string"==typeof e?"string":"hash"]:i.map}},174:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var i,n=0;n<e.length;n++)(i=e[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(0),a=(n=o)&&n.__esModule?n:{default:n};var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),s(e,[{key:"canUseWebP",value:function(){var t="object"===("undefined"==typeof document?"undefined":r(document))?document.createElement("canvas"):{};return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}},{key:"render",value:function(){var t=this.props,e=t.src,i=t.webp,n=t.alt,r=t.title,s=t.style,o=t.className,l=e;return!0===this.canUseWebP()&&(l=i),a.default.createElement("img",{src:l,alt:n,title:r,style:s,className:o})}}]),e}();e.default=l},175:function(t,e,i){},176:function(t,e,i){},189:function(t,e){var i=Array.isArray;t.exports=i},190:function(t,e,i){var n=i(222),r=i(584),s="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||r(t)&&n(t)==s}},191:function(t,e,i){var n=i(192).Symbol;t.exports=n},192:function(t,e,i){var n=i(581),r="object"==typeof self&&self&&self.Object===Object&&self,s=n||r||Function("return this")();t.exports=s},222:function(t,e,i){var n=i(191),r=i(582),s=i(583),o="[object Null]",a="[object Undefined]",l=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?a:o:l&&l in Object(t)?r(t):s(t)}},223:function(t,e,i){var n=i(592),r=i(597);t.exports=function(t,e){var i=r(t,e);return n(i)?i:void 0}},224:function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},225:function(t,e,i){"use strict";(t.exports={}).forEach=function(t,e){for(var i=0;i<t.length;i++){var n=e(t[i]);if(n)return n}}},226:function(t,e,i){"use strict";var n=t.exports={};n.isIE=function(t){return(-1!==(e=navigator.userAgent.toLowerCase()).indexOf("msie")||-1!==e.indexOf("trident")||-1!==e.indexOf(" edge/"))&&(!t||t===function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:void 0}());var e},n.isLegacyOpera=function(){return!!window.opera}},576:function(t,e,i){"use strict";var n=i(6),r=i(17),s=i(27),o=i(18),a=[].sort,l=[1,2,3];n(n.P+n.F*(o(function(){l.sort(void 0)})||!o(function(){l.sort(null)})||!i(14)(a)),"Array",{sort:function(t){return void 0===t?a.call(s(this)):a.call(s(this),r(t))}})},577:function(t,e,i){var n=i(578);t.exports=function(t,e,i){var r=null==t?void 0:n(t,e);return void 0===r?i:r}},578:function(t,e,i){var n=i(579),r=i(618);t.exports=function(t,e){for(var i=0,s=(e=n(e,t)).length;null!=t&&i<s;)t=t[r(e[i++])];return i&&i==s?t:void 0}},579:function(t,e,i){var n=i(189),r=i(580),s=i(585),o=i(615);t.exports=function(t,e){return n(t)?t:r(t,e)?[t]:s(o(t))}},580:function(t,e,i){var n=i(189),r=i(190),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!r(t))||o.test(t)||!s.test(t)||null!=e&&t in Object(e)}},581:function(t,e,i){(function(e){var i="object"==typeof e&&e&&e.Object===Object&&e;t.exports=i}).call(this,i(150))},582:function(t,e,i){var n=i(191),r=Object.prototype,s=r.hasOwnProperty,o=r.toString,a=n?n.toStringTag:void 0;t.exports=function(t){var e=s.call(t,a),i=t[a];try{t[a]=void 0;var n=!0}catch(t){}var r=o.call(t);return n&&(e?t[a]=i:delete t[a]),r}},583:function(t,e){var i=Object.prototype.toString;t.exports=function(t){return i.call(t)}},584:function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},585:function(t,e,i){var n=i(586),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,o=n(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,function(t,i,n,r){e.push(n?r.replace(s,"$1"):i||t)}),e});t.exports=o},586:function(t,e,i){var n=i(587),r=500;t.exports=function(t){var e=n(t,function(t){return i.size===r&&i.clear(),t}),i=e.cache;return e}},587:function(t,e,i){var n=i(588),r="Expected a function";function s(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(r);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],s=i.cache;if(s.has(r))return s.get(r);var o=t.apply(this,n);return i.cache=s.set(r,o)||s,o};return i.cache=new(s.Cache||n),i}s.Cache=n,t.exports=s},588:function(t,e,i){var n=i(589),r=i(610),s=i(612),o=i(613),a=i(614);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=s,l.prototype.has=o,l.prototype.set=a,t.exports=l},589:function(t,e,i){var n=i(590),r=i(602),s=i(609);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(s||r),string:new n}}},590:function(t,e,i){var n=i(591),r=i(598),s=i(599),o=i(600),a=i(601);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=s,l.prototype.has=o,l.prototype.set=a,t.exports=l},591:function(t,e,i){var n=i(168);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},592:function(t,e,i){var n=i(593),r=i(594),s=i(224),o=i(596),a=/^\[object .+?Constructor\]$/,l=Function.prototype,h=Object.prototype,u=l.toString,c=h.hasOwnProperty,d=RegExp("^"+u.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!s(t)||r(t))&&(n(t)?d:a).test(o(t))}},593:function(t,e,i){var n=i(222),r=i(224),s="[object AsyncFunction]",o="[object Function]",a="[object GeneratorFunction]",l="[object Proxy]";t.exports=function(t){if(!r(t))return!1;var e=n(t);return e==o||e==a||e==s||e==l}},594:function(t,e,i){var n,r=i(595),s=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!s&&s in t}},595:function(t,e,i){var n=i(192)["__core-js_shared__"];t.exports=n},596:function(t,e){var i=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},597:function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},598:function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},599:function(t,e,i){var n=i(168),r="__lodash_hash_undefined__",s=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var i=e[t];return i===r?void 0:i}return s.call(e,t)?e[t]:void 0}},600:function(t,e,i){var n=i(168),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:r.call(e,t)}},601:function(t,e,i){var n=i(168),r="__lodash_hash_undefined__";t.exports=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=n&&void 0===e?r:e,this}},602:function(t,e,i){var n=i(603),r=i(604),s=i(606),o=i(607),a=i(608);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=s,l.prototype.has=o,l.prototype.set=a,t.exports=l},603:function(t,e){t.exports=function(){this.__data__=[],this.size=0}},604:function(t,e,i){var n=i(169),r=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=n(e,t);return!(i<0||(i==e.length-1?e.pop():r.call(e,i,1),--this.size,0))}},605:function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},606:function(t,e,i){var n=i(169);t.exports=function(t){var e=this.__data__,i=n(e,t);return i<0?void 0:e[i][1]}},607:function(t,e,i){var n=i(169);t.exports=function(t){return n(this.__data__,t)>-1}},608:function(t,e,i){var n=i(169);t.exports=function(t,e){var i=this.__data__,r=n(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this}},609:function(t,e,i){var n=i(223)(i(192),"Map");t.exports=n},610:function(t,e,i){var n=i(170);t.exports=function(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},611:function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},612:function(t,e,i){var n=i(170);t.exports=function(t){return n(this,t).get(t)}},613:function(t,e,i){var n=i(170);t.exports=function(t){return n(this,t).has(t)}},614:function(t,e,i){var n=i(170);t.exports=function(t,e){var i=n(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this}},615:function(t,e,i){var n=i(616);t.exports=function(t){return null==t?"":n(t)}},616:function(t,e,i){var n=i(191),r=i(617),s=i(189),o=i(190),a=1/0,l=n?n.prototype:void 0,h=l?l.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(s(e))return r(e,t)+"";if(o(e))return h?h.call(e):"";var i=e+"";return"0"==i&&1/e==-a?"-0":i}},617:function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}},618:function(t,e,i){var n=i(190),r=1/0;t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-r?"-0":e}},619:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}(i(620))},620:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=i(621),s=n(i(622)),o=function(){function t(t){void 0===t&&(t=document.body),this.count=300,this.color="#ffffff",this.width=0,this.height=0,this.snowflakes=[],this.animationId=0,this.erd=s.default(),this.active=!1,this.container=t}return t.prototype.start=function(){var t=this;this.canvas||this.init(),this.active=!0,this.animationId||(this.animationId=requestAnimationFrame(function(){return t.update()}))},t.prototype.pause=function(){this.active=!1},t.prototype.toggle=function(){this.active?this.pause():this.start()},t.prototype.init=function(){var t=this;this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left=this.canvas.style.top="0",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="500",this.onResize(),this.setupTheSnow(),this.erd.listenTo(this.container,function(e){t.onResize()})},t.prototype.destroy=function(){this.canvas&&(this.canvas.remove(),this.canvas=null,this.ctx=null,this.animationId=0,this.snowflakes.length=0,this.erd.removeAllListeners(this.container))},t.prototype.setupTheSnow=function(){if(this.canvas){for(var t=0;t<this.count;t++){var e=new r.Snowflake;e.reset(this.width,this.height),this.snowflakes.push(e)}this.container.appendChild(this.canvas)}},t.prototype.onResize=function(){this.canvas&&this.ctx&&(this.width=this.container.clientWidth,this.height=this.container.clientHeight>1e4?1e4:this.container.clientHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.ctx.fillStyle=this.color)},t.prototype.update=function(){var t=this;if(this.ctx){this.ctx.clearRect(0,0,this.width,this.height);for(var e=0,i=0;i<this.count;i++){var n=this.snowflakes[i];this.active||!(n.y<0||n.y>this.height)?(n.y+=n.vy,n.x+=n.vx,this.ctx.globalAlpha=n.o,this.ctx.beginPath(),this.ctx.arc(n.x,n.y,n.r,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.fill(),n.y>this.height&&this.active&&n.reset(this.width,this.height)):e++}e===this.count?this.destroy():this.animationId=requestAnimationFrame(function(){return t.update()})}},t}();e.Snowflakes=o},621:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.x=0,this.y=0,this.vx=0,this.vy=0,this.r=0,this.o=0,this.sleep=!1}return t.prototype.reset=function(t,e){this.x=Math.random()*t,this.y=Math.random()*(e<100?-800:-e),this.vy=1+3*Math.random(),this.vx=.5-Math.random(),this.r=1+2*Math.random(),this.o=.5+.5*Math.random(),this.sleep=!1},t}();e.Snowflake=n},622:function(t,e,i){"use strict";var n=i(225).forEach,r=i(623),s=i(624),o=i(625),a=i(626),l=i(627),h=i(226),u=i(628),c=i(630),d=i(631),f=i(632);function p(t){return Array.isArray(t)||void 0!==t.length}function g(t){if(Array.isArray(t))return t;var e=[];return n(t,function(t){e.push(t)}),e}function m(t){return t&&1===t.nodeType}function _(t,e,i){var n=t[e];return null==n&&void 0!==i?i:n}t.exports=function(t){var e;if((t=t||{}).idHandler)e={get:function(e){return t.idHandler.get(e,!0)},set:t.idHandler.set};else{var i=o(),y=a({idGenerator:i,stateHandler:c});e=y}var v=t.reporter;v||(v=l(!1===v));var b=_(t,"batchProcessor",u({reporter:v})),w={};w.callOnAdd=!!_(t,"callOnAdd",!0),w.debug=!!_(t,"debug",!1);var x,$=s(e),M=r({stateHandler:c}),z=_(t,"strategy","object"),D={reporter:v,batchProcessor:b,stateHandler:c,idHandler:e};if("scroll"===z&&(h.isLegacyOpera()?(v.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),z="object"):h.isIE(9)&&(v.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),z="object")),"scroll"===z)x=f(D);else{if("object"!==z)throw new Error("Invalid strategy name: "+z);x=d(D)}var A={};return{listenTo:function(t,i,r){function s(t){var e=$.get(t);n(e,function(e){e(t)})}function o(t,e,i){$.add(e,i),t&&i(e)}if(r||(r=i,i=t,t={}),!i)throw new Error("At least one element required.");if(!r)throw new Error("Listener required.");if(m(i))i=[i];else{if(!p(i))return v.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");i=g(i)}var a=0,l=_(t,"callOnAdd",w.callOnAdd),h=_(t,"onReady",function(){}),u=_(t,"debug",w.debug);n(i,function(t){c.getState(t)||(c.initState(t),e.set(t));var d=e.get(t);if(u&&v.log("Attaching listener to element",d,t),!M.isDetectable(t))return u&&v.log(d,"Not detectable."),M.isBusy(t)?(u&&v.log(d,"System busy making it detectable"),o(l,t,r),A[d]=A[d]||[],void A[d].push(function(){++a===i.length&&h()})):(u&&v.log(d,"Making detectable..."),M.markBusy(t,!0),x.makeDetectable({debug:u},t,function(t){if(u&&v.log(d,"onElementDetectable"),c.getState(t)){M.markAsDetectable(t),M.markBusy(t,!1),x.addListener(t,s),o(l,t,r);var e=c.getState(t);if(e&&e.startSize){var f=t.offsetWidth,p=t.offsetHeight;e.startSize.width===f&&e.startSize.height===p||s(t)}A[d]&&n(A[d],function(t){t()})}else u&&v.log(d,"Element uninstalled before being detectable.");delete A[d],++a===i.length&&h()}));u&&v.log(d,"Already detecable, adding listener."),o(l,t,r),a++}),a===i.length&&h()},removeListener:$.removeListener,removeAllListeners:$.removeAllListeners,uninstall:function(t){if(!t)return v.error("At least one element is required.");if(m(t))t=[t];else{if(!p(t))return v.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");t=g(t)}n(t,function(t){$.removeAllListeners(t),x.uninstall(t),c.cleanState(t)})}}}},623:function(t,e,i){"use strict";t.exports=function(t){var e=t.stateHandler.getState;return{isDetectable:function(t){var i=e(t);return i&&!!i.isDetectable},markAsDetectable:function(t){e(t).isDetectable=!0},isBusy:function(t){return!!e(t).busy},markBusy:function(t,i){e(t).busy=!!i}}}},624:function(t,e,i){"use strict";t.exports=function(t){var e={};function i(i){var n=t.get(i);return void 0===n?[]:e[n]||[]}return{get:i,add:function(i,n){var r=t.get(i);e[r]||(e[r]=[]),e[r].push(n)},removeListener:function(t,e){for(var n=i(t),r=0,s=n.length;r<s;++r)if(n[r]===e){n.splice(r,1);break}},removeAllListeners:function(t){var e=i(t);e&&(e.length=0)}}}},625:function(t,e,i){"use strict";t.exports=function(){var t=1;return{generate:function(){return t++}}}},626:function(t,e,i){"use strict";t.exports=function(t){var e=t.idGenerator,i=t.stateHandler.getState;return{get:function(t){var e=i(t);return e&&void 0!==e.id?e.id:null},set:function(t){var n=i(t);if(!n)throw new Error("setId required the element to have a resize detection state.");var r=e.generate();return n.id=r,r}}}},627:function(t,e,i){"use strict";t.exports=function(t){function e(){}var i={log:e,warn:e,error:e};if(!t&&window.console){var n=function(t,e){t[e]=function(){var t=console[e];if(t.apply)t.apply(console,arguments);else for(var i=0;i<arguments.length;i++)t(arguments[i])}};n(i,"log"),n(i,"warn"),n(i,"error")}return i}},628:function(t,e,i){"use strict";var n=i(629);function r(){var t={},e=0,i=0,n=0;return{add:function(r,s){s||(s=r,r=0),r>i?i=r:r<n&&(n=r),t[r]||(t[r]=[]),t[r].push(s),e++},process:function(){for(var e=n;e<=i;e++)for(var r=t[e],s=0;s<r.length;s++)(0,r[s])()},size:function(){return e}}}t.exports=function(t){var e=(t=t||{}).reporter,i=n.getOption(t,"async",!0),s=n.getOption(t,"auto",!0);s&&!i&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),i=!0);var o,a=r(),l=!1;function h(){for(l=!0;a.size();){var t=a;a=r(),t.process()}l=!1}function u(){var t;t=h,o=setTimeout(t,0)}return{add:function(t,e){!l&&s&&i&&0===a.size()&&u(),a.add(t,e)},force:function(t){l||(void 0===t&&(t=i),o&&(clearTimeout(o),o=null),t?u():h())}}}},629:function(t,e,i){"use strict";(t.exports={}).getOption=function(t,e,i){var n=t[e];if(null==n&&void 0!==i)return i;return n}},630:function(t,e,i){"use strict";var n="_erd";function r(t){return t[n]}t.exports={initState:function(t){return t[n]={},r(t)},getState:r,cleanState:function(t){delete t[n]}}},631:function(t,e,i){"use strict";var n=i(226);t.exports=function(t){var e=(t=t||{}).reporter,i=t.batchProcessor,r=t.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function s(t){return r(t).object}return{makeDetectable:function(t,s,o){o||(o=s,s=t,t=null),(t=t||{}).debug,n.isIE(8)?o(s):function(t,s){var o="display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; padding: 0; margin: 0; opacity: 0; z-index: -1000; pointer-events: none;",a=!1,l=window.getComputedStyle(t),h=t.offsetWidth,u=t.offsetHeight;function c(){function i(){if("static"===l.position){t.style.position="relative";var i=function(t,e,i,n){var r=i[n];"auto"!==r&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(r)&&(t.warn("An element that is positioned static has style."+n+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",e),e.style[n]=0)};i(e,t,l,"top"),i(e,t,l,"right"),i(e,t,l,"bottom"),i(e,t,l,"left")}}""!==l.position&&(i(),a=!0);var h=document.createElement("object");h.style.cssText=o,h.tabIndex=-1,h.type="text/html",h.onload=function(){a||i(),function t(e,i){e.contentDocument?i(e.contentDocument):setTimeout(function(){t(e,i)},100)}(this,function(e){s(t)})},n.isIE()||(h.data="about:blank"),t.appendChild(h),r(t).object=h,n.isIE()&&(h.data="about:blank")}r(t).startSize={width:h,height:u},i?i.add(c):c()}(s,o)},addListener:function(t,e){if(!s(t))throw new Error("Element is not detectable by this strategy.");function i(){e(t)}n.isIE(8)?(r(t).object={proxy:i},t.attachEvent("onresize",i)):s(t).contentDocument.defaultView.addEventListener("resize",i)},uninstall:function(t){n.isIE(8)?t.detachEvent("onresize",r(t).object.proxy):t.removeChild(s(t)),delete r(t).object}}}},632:function(t,e,i){"use strict";var n=i(225).forEach;t.exports=function(t){var e=(t=t||{}).reporter,i=t.batchProcessor,r=t.stateHandler.getState,s=(t.stateHandler.hasState,t.idHandler);if(!i)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var o=function(){var t=document.createElement("div");t.style.cssText="position: absolute; width: 1000px; height: 1000px; visibility: hidden; margin: 0; padding: 0;";var e=document.createElement("div");e.style.cssText="position: absolute; width: 500px; height: 500px; overflow: scroll; visibility: none; top: -1500px; left: -1500px; visibility: hidden; margin: 0; padding: 0;",e.appendChild(t),document.body.insertBefore(e,document.body.firstChild);var i=500-e.clientWidth,n=500-e.clientHeight;return document.body.removeChild(e),{width:i,height:n}}(),a="erd_scroll_detection_container";function l(t,i,n){if(t.addEventListener)t.addEventListener(i,n);else{if(!t.attachEvent)return e.error("[scroll] Don't know how to add event listeners.");t.attachEvent("on"+i,n)}}function h(t,i,n){if(t.removeEventListener)t.removeEventListener(i,n);else{if(!t.detachEvent)return e.error("[scroll] Don't know how to remove event listeners.");t.detachEvent("on"+i,n)}}function u(t){return r(t).container.childNodes[0].childNodes[0].childNodes[0]}function c(t){return r(t).container.childNodes[0].childNodes[0].childNodes[1]}return function(t,e){if(!document.getElementById(t)){var i=e+"_animation",n=e+"_animation_active",r="/* Created by the element-resize-detector library. */\n";r+="."+e+" > div::-webkit-scrollbar { display: none; }\n\n",r+="."+n+" { -webkit-animation-duration: 0.1s; animation-duration: 0.1s; -webkit-animation-name: "+i+"; animation-name: "+i+"; }\n",r+="@-webkit-keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",function(e,i){i=i||function(t){document.head.appendChild(t)};var n=document.createElement("style");n.innerHTML=e,n.id=t,i(n)}(r+="@keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}("erd_scroll_detection_scrollbar_style",a),{makeDetectable:function(t,h,d){function f(){if(t.debug){var i=Array.prototype.slice.call(arguments);if(i.unshift(s.get(h),"Scroll: "),e.log.apply)e.log.apply(null,i);else for(var n=0;n<i.length;n++)e.log(i[n])}}function p(t){var e=r(t).container.childNodes[0],i=window.getComputedStyle(e);return!i.width||-1===i.width.indexOf("px")}function g(){var t=window.getComputedStyle(h),e={};return e.position=t.position,e.width=h.offsetWidth,e.height=h.offsetHeight,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e.widthCSS=t.width,e.heightCSS=t.height,e}function m(){if(f("storeStyle invoked."),r(h)){var t=g();r(h).style=t}else f("Aborting because element has been uninstalled")}function _(t,e,i){r(t).lastWidth=e,r(t).lastHeight=i}function y(){return 2*o.width+1}function v(){return 2*o.height+1}function b(t){return t+10+y()}function w(t){return t+10+v()}function x(t,e,i){var n=u(t),r=c(t),s=b(e),o=w(i),a=function(t){return 2*t+y()}(e),l=function(t){return 2*t+v()}(i);n.scrollLeft=s,n.scrollTop=o,r.scrollLeft=a,r.scrollTop=l}function $(){var t=r(h).container;if(!t){(t=document.createElement("div")).className=a,t.style.cssText="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0; padding: 0;",r(h).container=t,function(t){t.className+=" "+a+"_animation_active"}(t),h.appendChild(t);var e=function(){r(h).onRendered&&r(h).onRendered()};l(t,"animationstart",e),r(h).onAnimationStart=e}return t}function M(){if(f("Injecting elements"),r(h)){!function(){var t=r(h).style;if("static"===t.position){h.style.position="relative";var i=function(t,e,i,n){var r=i[n];"auto"!==r&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(r)&&(t.warn("An element that is positioned static has style."+n+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",e),e.style[n]=0)};i(e,h,t,"top"),i(e,h,t,"right"),i(e,h,t,"bottom"),i(e,h,t,"left")}}();var t=r(h).container;t||(t=$());var i,n,s,u,c=o.width,d=o.height,p="position: absolute; flex: none; overflow: hidden; z-index: -1; visibility: hidden; left: "+(i=(i=-(1+c))?i+"px":"0")+"; top: "+(n=(n=-(1+d))?n+"px":"0")+"; right: "+(u=(u=-c)?u+"px":"0")+"; bottom: "+(s=(s=-d)?s+"px":"0")+";",g=document.createElement("div"),m=document.createElement("div"),_=document.createElement("div"),y=document.createElement("div"),v=document.createElement("div"),b=document.createElement("div");g.dir="ltr",g.style.cssText="position: absolute; flex: none; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;",g.className=a,m.className=a,m.style.cssText=p,_.style.cssText="position: absolute; flex: none; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;",y.style.cssText="position: absolute; left: 0; top: 0;",v.style.cssText="position: absolute; flex: none; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;",b.style.cssText="position: absolute; width: 200%; height: 200%;",_.appendChild(y),v.appendChild(b),m.appendChild(_),m.appendChild(v),g.appendChild(m),t.appendChild(g),l(_,"scroll",w),l(v,"scroll",x),r(h).onExpandScroll=w,r(h).onShrinkScroll=x}else f("Aborting because element has been uninstalled");function w(){r(h).onExpand&&r(h).onExpand()}function x(){r(h).onShrink&&r(h).onShrink()}}function z(){function o(t,e,i){var n=function(t){return u(t).childNodes[0]}(t),r=b(e),s=w(i);n.style.width=r+"px",n.style.height=s+"px"}function a(n){var a=h.offsetWidth,u=h.offsetHeight;f("Storing current size",a,u),_(h,a,u),i.add(0,function(){if(r(h))if(l()){if(t.debug){var i=h.offsetWidth,n=h.offsetHeight;i===a&&n===u||e.warn(s.get(h),"Scroll: Size changed before updating detector elements.")}o(h,a,u)}else f("Aborting because element container has not been initialized");else f("Aborting because element has been uninstalled")}),i.add(1,function(){r(h)?l()?x(h,a,u):f("Aborting because element container has not been initialized"):f("Aborting because element has been uninstalled")}),n&&i.add(2,function(){r(h)?l()?n():f("Aborting because element container has not been initialized"):f("Aborting because element has been uninstalled")})}function l(){return!!r(h).container}function d(){f("notifyListenersIfNeeded invoked");var t=r(h);return void 0===r(h).lastNotifiedWidth&&t.lastWidth===t.startSize.width&&t.lastHeight===t.startSize.height?f("Not notifying: Size is the same as the start size, and there has been no notification yet."):t.lastWidth===t.lastNotifiedWidth&&t.lastHeight===t.lastNotifiedHeight?f("Not notifying: Size already notified"):(f("Current size not notified, notifying..."),t.lastNotifiedWidth=t.lastWidth,t.lastNotifiedHeight=t.lastHeight,void n(r(h).listeners,function(t){t(h)}))}function g(){if(f("Scroll detected."),p(h))f("Scroll event fired while unrendered. Ignoring...");else{var t=h.offsetWidth,e=h.offsetHeight;t!==r(h).lastWidth||e!==r(h).lastHeight?(f("Element size changed."),a(d)):f("Element size has not changed ("+t+"x"+e+").")}}if(f("registerListenersAndPositionElements invoked."),r(h)){r(h).onRendered=function(){if(f("startanimation triggered."),p(h))f("Ignoring since element is still unrendered...");else{f("Element rendered.");var t=u(h),e=c(h);0!==t.scrollLeft&&0!==t.scrollTop&&0!==e.scrollLeft&&0!==e.scrollTop||(f("Scrollbars out of sync. Updating detector elements..."),a(d))}},r(h).onExpand=g,r(h).onShrink=g;var m=r(h).style;o(h,m.width,m.height)}else f("Aborting because element has been uninstalled")}function D(){if(f("finalizeDomMutation invoked."),r(h)){var t=r(h).style;_(h,t.width,t.height),x(h,t.width,t.height)}else f("Aborting because element has been uninstalled")}function A(){d(h)}function C(){var t;f("Installing..."),r(h).listeners=[],t=g(),r(h).startSize={width:t.width,height:t.height},f("Element start size",r(h).startSize),i.add(0,m),i.add(1,M),i.add(2,z),i.add(3,D),i.add(4,A)}d||(d=h,h=t,t=null),t=t||{},f("Making detectable..."),function(t){return!function(t){return t===t.ownerDocument.body||t.ownerDocument.body.contains(t)}(t)||null===window.getComputedStyle(t)}(h)?(f("Element is detached"),$(),f("Waiting until element is attached..."),r(h).onRendered=function(){f("Element is now attached"),C()}):C()},addListener:function(t,e){if(!r(t).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");r(t).listeners.push(e)},uninstall:function(t){var e=r(t);e&&(e.onExpandScroll&&h(u(t),"scroll",e.onExpandScroll),e.onShrinkScroll&&h(c(t),"scroll",e.onShrinkScroll),e.onAnimationStart&&h(e.container,"animationstart",e.onAnimationStart),e.container&&t.removeChild(e.container))}}}},633:function(t,e,i){},660:function(t,e,i){"use strict";const n={xy:"xy",yz:"yz",xz:"xz",xyz:"xyz",horizontal:0,vertical:1,identical:0,right:4,bottom_right:5,bottom:6,bottom_left:7,left:8,top_left:1,top:2,top_right:3,epsilon:1e-4,max:Number.MAX_VALUE,min:Number.MIN_VALUE,pi:Math.PI,two_pi:6.283185307179586,half_pi:1.5707963267948966,quarter_pi:.7853981633974483,one_degree:.017453292519943295,rad_to_deg:57.29577951308232,deg_to_rad:.017453292519943295,gravity:9.81,newton:.10197,gaussian:.3989422804014327};class r{static warnLevel(t){return t&&(r._warnLevel=t),r._warnLevel}static getArgs(t){if(t.length<1)return[];let e=[],i=Array.isArray(t[0])||ArrayBuffer.isView(t[0]);if("number"==typeof t[0])e=Array.prototype.slice.call(t);else if("object"!=typeof t[0]||i)i&&(e=[].slice.call(t[0]));else{let i=["x","y","z","w"],n=t[0];for(let t=0;t<i.length&&(!(n.length&&t>=n.length)&&i[t]in n);t++)e.push(n[i[t]])}return e}static warn(t="error",e){if("error"==r.warnLevel())throw new Error(t);return"warn"==r.warnLevel()&&console.warn(t),e}static randomInt(t,e=0){return Math.floor(Math.random()*t)+e}static split(t,e,i,n=!1){let r=i||e,s=[];for(let i=0;i<t.length;i++)if(i*r+e>t.length){if(!n)break;{let n=t.slice(i*r);n=n.concat(t.slice(0,(i*r+e)%e)),s.push(n)}}else s.push(t.slice(i*r,i*r+e));return s}static flatten(t,e=!0){let i=e?new v:new Array;return i.concat.apply(i,t)}static combine(t,e,i){let n=[];for(let r=0,s=t.length;r<s;r++)for(let s=0,o=e.length;s<o;s++)n.push(i(t[r],e[s]));return n}static zip(t){let e=[];for(let i=0,n=t[0].length;i<n;i++){let n=[];for(let e=0;e<t.length;e++)n.push(t[e][i]);e.push(n)}return e}static stepper(t,e=0,i=1,n){let r=e;return function(){return(r+=i)>=t&&(r=e+(r-t)),n&&n(r),r}}static forRange(t,e,i=0,n=1){let r=[];for(let s=i,o=e;s<o;s+=n)r[s]=t(s);return r}}r._warnLevel="mute";class s{static add(t,e){if("number"==typeof e)for(let i=0,n=t.length;i<n;i++)t[i]+=e;else for(let i=0,n=t.length;i<n;i++)t[i]+=e[i]||0;return t}static subtract(t,e){if("number"==typeof e)for(let i=0,n=t.length;i<n;i++)t[i]-=e;else for(let i=0,n=t.length;i<n;i++)t[i]-=e[i]||0;return t}static multiply(t,e){if("number"==typeof e)for(let i=0,n=t.length;i<n;i++)t[i]*=e;else{if(t.length!=e.length)throw new Error(`Cannot do element-wise multiply since the array lengths don't match: ${t.toString()} multiply-with ${e.toString()}`);for(let i=0,n=t.length;i<n;i++)t[i]*=e[i]}return t}static divide(t,e){if("number"==typeof e){if(0===e)throw new Error("Cannot divide by zero");for(let i=0,n=t.length;i<n;i++)t[i]/=e}else{if(t.length!=e.length)throw new Error(`Cannot do element-wise divide since the array lengths don't match. ${t.toString()} divide-by ${e.toString()}`);for(let i=0,n=t.length;i<n;i++)t[i]/=e[i]}return t}static dot(t,e){if(t.length!=e.length)throw new Error("Array lengths don't match");let i=0;for(let n=0,r=t.length;n<r;n++)i+=t[n]*e[n];return i}static cross2D(t,e){return t[0]*e[1]-t[1]*e[0]}static cross(t,e){return new y(t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0])}static magnitude(t){return Math.sqrt(s.dot(t,t))}static unit(t,e){let i=void 0===e?s.magnitude(t):e;if(0===i)throw new Error("Cannot calculate unit vector because magnitude is 0");return s.divide(t,i)}static abs(t){return s.map(t,Math.abs)}static floor(t){return s.map(t,Math.floor)}static ceil(t){return s.map(t,Math.ceil)}static round(t){return s.map(t,Math.round)}static max(t){let e=Number.MIN_VALUE,i=0;for(let n=0,r=t.length;n<r;n++)(e=Math.max(e,t[n]))===t[n]&&(i=n);return{value:e,index:i}}static min(t){let e=Number.MAX_VALUE,i=0;for(let n=0,r=t.length;n<r;n++)(e=Math.min(e,t[n]))===t[n]&&(i=n);return{value:e,index:i}}static sum(t){let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i];return e}static map(t,e){for(let i=0,n=t.length;i<n;i++)t[i]=e(t[i],i,t);return t}}class o{static add(t,e){if("number"!=typeof e){if(t[0].length!=e[0].length)throw new Error("Cannot add matrix if rows' and columns' size don't match.");if(t.length!=e.length)throw new Error("Cannot add matrix if rows' and columns' size don't match.")}let i=new v,n="number"==typeof e;for(let r=0,s=t.length;r<s;r++)i.push(t[r].$add(n?e:e[r]));return i}static multiply(t,e,i=!1,n=!1){let r=new v;if("number"!=typeof e)if(n){if(t.length!=e.length)throw new Error("Cannot multiply matrix element-wise because the matrices' sizes don't match.");for(let i=0,n=t.length;i<n;i++)r.push(t[i].$multiply(e[i]))}else{if(!i&&t[0].length!=e.length)throw new Error("Cannot multiply matrix if rows in matrix-a don't match columns in matrix-b.");if(i&&t[0].length!=e[0].length)throw new Error("Cannot multiply matrix if transposed and the columns in both matrices don't match.");i||(e=o.transpose(e));for(let i=0,n=t.length;i<n;i++){let n=y.make(e.length,0);for(let r=0,o=e.length;r<o;r++)n[r]=s.dot(t[i],e[r]);r.push(n)}}else for(let i=0,n=t.length;i<n;i++)r.push(t[i].$multiply(e));return r}static zipSlice(t,e,i=!1){let n=[];for(let r=0,s=t.length;r<s;r++){if(t[r].length-1<e&&!1===i)throw`Index ${e} is out of bounds`;n.push(t[r][e]||i)}return new y(n)}static zip(t,e=!1,i=!1){let n=new v,r=i?t.reduce((t,e)=>Math.max(t,e.length),0):t[0].length;for(let i=0;i<r;i++)n.push(o.zipSlice(t,i,e));return n}static transpose(t,e=!1,i=!1){return o.zip(t,e,i)}static transform2D(t,e){let i=t[0]*e[0][0]+t[1]*e[1][0]+e[2][0],n=t[0]*e[0][1]+t[1]*e[1][1]+e[2][1];return new y(i,n)}static scale2DMatrix(t,e){return new v(new y(t,0,0),new y(0,e,0),new y(0,0,1))}static rotate2DMatrix(t,e){return new v(new y(t,e,0),new y(-e,t,0),new y(0,0,1))}static shear2DMatrix(t,e){return new v(new y(1,t,0),new y(e,1,0),new y(0,0,1))}static translate2DMatrix(t,e){return new v(new y(1,0,0),new y(0,1,0),new y(t,e,1))}static scaleAt2DMatrix(t,e,i){let n=o.scale2DMatrix(t,e);return n[2][0]=-i[0]*t+i[0],n[2][1]=-i[1]*e+i[1],n}static rotateAt2DMatrix(t,e,i){let n=o.rotate2DMatrix(t,e);return n[2][0]=i[0]*(1-t)+i[1]*e,n[2][1]=i[1]*(1-t)-i[0]*e,n}static shearAt2DMatrix(t,e,i){let n=o.shear2DMatrix(t,e);return n[2][0]=-i[1]*e,n[2][1]=-i[0]*t,n}static reflectAt2DMatrix(t,e){let i=h.intercept(t,e);if(null==i)return[new y([-1,0,0]),new y([0,1,0]),new y([t[0]+e[0],0,1])];{let t=i.yi,e=2*Math.atan(i.slope),n=Math.cos(e),r=Math.sin(e);return[new y([n,r,0]),new y([r,-n,0]),new y([-t*r,t+t*n,1])]}}}let a=(t,e="expected")=>r.warn("Group's length is less than "+e,t),l=(t,e="")=>r.warn(`Index ${e} is out of bound in Group`,t);class h{static fromAngle(t,e,i){let n=new v(new y(t),new y(t));return n[1].toAngle(e,i,!0),n}static slope(t,e){return e[0]-t[0]==0?void 0:(e[1]-t[1])/(e[0]-t[0])}static intercept(t,e){if(e[0]-t[0]!=0){let i=(e[1]-t[1])/(e[0]-t[0]),n=t[1]-i*t[0];return{slope:i,yi:n,xi:0===i?void 0:-n/i}}}static sideOfPt2D(t,e){return(t[1][0]-t[0][0])*(e[1]-t[0][1])-(e[0]-t[0][0])*(t[1][1]-t[0][1])}static collinear(t,e,i,n=.01){let r=new y(0,0,0).to(t).$subtract(e),s=new y(0,0,0).to(t).$subtract(i);return r.$cross(s).divide(1e3).equals(new y(0,0,0),n)}static magnitude(t){return t.length>=2?t[1].$subtract(t[0]).magnitude():0}static magnitudeSq(t){return t.length>=2?t[1].$subtract(t[0]).magnitudeSq():0}static perpendicularFromPt(t,e,i=!1){if(t[0].equals(t[1]))return;let n=t[0].$subtract(t[1]),r=t[1].$subtract(e),s=r.$subtract(n.$project(r));return i?s:s.$add(e)}static distanceFromPt(t,e){return h.perpendicularFromPt(t,e,!0).magnitude()}static intersectRay2D(t,e){let i=h.intercept(t[0],t[1]),n=h.intercept(e[0],e[1]),r=t[0],s=e[0];if(null==i){if(null==n)return;let t=-n.slope*(s[0]-r[0])+s[1];return new y(r[0],t)}if(null==n){let t=-i.slope*(r[0]-s[0])+r[1];return new y(s[0],t)}if(n.slope!=i.slope){let t=(i.slope*r[0]-n.slope*s[0]+s[1]-r[1])/(i.slope-n.slope),e=i.slope*(t-r[0])+r[1];return new y(t,e)}return i.yi==n.yi?new y(r[0],r[1]):void 0}static intersectLine2D(t,e){let i=h.intersectRay2D(t,e);return i&&g.withinBound(i,t[0],t[1])&&g.withinBound(i,e[0],e[1])?i:void 0}static intersectLineWithRay2D(t,e){let i=h.intersectRay2D(t,e);return i&&g.withinBound(i,t[0],t[1])?i:void 0}static intersectPolygon2D(t,e,i=!1){let n=i?h.intersectLineWithRay2D:h.intersectLine2D,r=new v;for(let i=0,s=e.length;i<s;i++){let o=i===s-1?0:i+1,a=n([e[i],e[o]],t);a&&r.push(a)}return r.length>0?r:void 0}static intersectLines2D(t,e,i=!1){let n=new v,r=i?h.intersectLineWithRay2D:h.intersectLine2D;for(let i=0,s=t.length;i<s;i++)for(let s=0,o=e.length;s<o;s++){let o=r(t[i],e[s]);o&&n.push(o)}return n}static intersectGridWithRay2D(t,e){let i=h.intercept(new y(t[0]).subtract(e),new y(t[1]).subtract(e)),n=new v;return i&&i.xi&&n.push(new y(e[0]+i.xi,e[1])),i&&i.yi&&n.push(new y(e[0],e[1]+i.yi)),n}static intersectGridWithLine2D(t,e){let i=h.intersectGridWithRay2D(t,e),n=new v;for(let e=0,r=i.length;e<r;e++)g.withinBound(i[e],t[0],t[1])&&n.push(i[e]);return n}static intersectRect2D(t,e){let i=g.boundingBox(v.fromPtArray(t));return u.hasIntersectRect2D(i,e)?h.intersectLines2D([t],u.sides(e)):new v}static subpoints(t,e){let i=new v;for(let n=1;n<=e;n++)i.push(g.interpolate(t[0],t[1],n/(e+1)));return i}static crop(t,e,i=0,n=!0){let r=t[0===i?1:0].$subtract(t[i]);if(0===r[0]||0===e[0])return t[i];if(n){let n=r.unit().multiply(e[1]);return t[i].$add(n)}{let n=u.fromCenter(t[i],e),s=u.sides(n),o=0;return o=Math.abs(r[1]/r[0])>Math.abs(e[1]/e[0])?r[1]<0?0:2:r[0]<0?3:1,h.intersectRay2D(s[o],t)}}static marker(t,e,i="arrow",n=!0){let r=n?1:0,s=t[n?0:1].$subtract(t[r]);if(0===s.magnitudeSq())return new v;s.unit();let o=g.perpendicular(s).multiply(e[0]).add(t[r]);return"arrow"==i?(o.add(s.$multiply(e[1])),new v(t[r],o[0],o[1])):new v(o[0],o[1])}static toRect(t){return new v(t[0].$min(t[1]),t[0].$max(t[1]))}}class u{static from(t,e,i){return u.fromTopLeft(t,e,i)}static fromTopLeft(t,e,i){let n="number"==typeof e?[e,i||e]:e;return new v(new y(t),new y(t).add(n))}static fromCenter(t,e,i){let n="number"==typeof e?[e/2,(i||e)/2]:new y(e).divide(2);return new v(new y(t).subtract(n),new y(t).add(n))}static toCircle(t,e=!0){return c.fromRect(t,e)}static toSquare(t,e=!1){let i=u.size(t),n=e?i.maxValue().value:i.minValue().value;return u.fromCenter(u.center(t),n,n)}static size(t){return t[0].$max(t[1]).subtract(t[0].$min(t[1]))}static center(t){let e=t[0].$min(t[1]),i=t[0].$max(t[1]);return e.add(i.$subtract(e).divide(2))}static corners(t){let e=t[0].$min(t[1]),i=t[0].$max(t[1]);return new v(e,new y(i.x,e.y),i,new y(e.x,i.y))}static sides(t){let[e,i,n,r]=u.corners(t);return[new v(e,i),new v(i,n),new v(n,r),new v(r,e)]}static boundingBox(t){let e=r.flatten(t,!1),i=y.make(2,Number.MAX_VALUE),n=y.make(2,Number.MIN_VALUE);for(let t=0,r=e.length;t<r;t++)for(let r=0;r<2;r++)i[r]=Math.min(i[r],e[t][r]),n[r]=Math.max(n[r],e[t][r]);return new v(i,n)}static polygon(t){return u.corners(t)}static quadrants(t,e){let i=u.corners(t),n=null!=e?new y(e):u.center(t);return i.map(t=>new v(t,n).boundingBox())}static halves(t,e=.5,i=!1){let n=t[0].$min(t[1]),r=t[0].$max(t[1]),s=i?p.lerp(n[1],r[1],e):p.lerp(n[0],r[0],e);return i?[new v(n,new y(r[0],s)),new v(new y(n[0],s),r)]:[new v(n,new y(s,r[1])),new v(new y(s,n[1]),r)]}static withinBound(t,e){return g.withinBound(e,t[0],t[1])}static hasIntersectRect2D(t,e,i=!1){return i&&(t=g.boundingBox(t),e=g.boundingBox(e)),!(t[0][0]>e[1][0]||e[0][0]>t[1][0])&&!(t[0][1]>e[1][1]||e[0][1]>t[1][1])}static intersectRect2D(t,e){return u.hasIntersectRect2D(t,e)?h.intersectLines2D(u.sides(t),u.sides(e)):new v}}class c{static fromRect(t,e=!1){let i=0,n=i=u.size(t).minValue().value/2;if(e){let e=u.size(t).maxValue().value/2;i=Math.sqrt(n*n+e*e)}else i=n;return new v(u.center(t),new y(i,i))}static fromCenter(t,e){return new v(new y(t),new y(e,e))}static withinBound(t,e,i=0){let n=t[0].$subtract(e);return n.dot(n)+i<t[1].x*t[1].x}static intersectRay2D(t,e){let i=e[0].$subtract(e[1]),n=t[0].$subtract(e[0]),r=i.dot(i),s=n.dot(i)/r,o=s*s-(n.dot(n)-t[1].x*t[1].x)/r;if(o<0)return new v;{let t=Math.sqrt(o),n=-s+t,r=e[0].$subtract(i.$multiply(n));if(0===o)return new v(r);let a=-s-t,l=e[0].$subtract(i.$multiply(a));return new v(r,l)}}static intersectLine2D(t,e){let i=c.intersectRay2D(t,e),n=new v;if(i.length>0)for(let t=0,r=i.length;t<r;t++)u.withinBound(e,i[t])&&n.push(i[t]);return n}static intersectCircle2D(t,e){let i=e[0].$subtract(t[0]),n=i.magnitudeSq(),r=Math.sqrt(n),s=t[1].x,o=e[1].x,a=s*s,l=o*o;if(r>s+o)return new v;if(r<Math.abs(s-o))return new v(t[0].clone());{let e=(a-l+n)/(2*r),s=Math.sqrt(a-e*e),o=i.$multiply(e/r).add(t[0]);return new v(new y(o.x+s*i.y/r,o.y-s*i.x/r),new y(o.x-s*i.y/r,o.y+s*i.x/r))}}static intersectRect2D(t,e){let i=u.sides(e),n=[];for(let e=0,r=i.length;e<r;e++){let r=c.intersectLine2D(t,i[e]);r.length>0&&n.push(r)}return r.flatten(n)}static toRect(t,e=!1){let i=t[1][0];if(e){let e=Math.sqrt(i*i)/2;return new v(t[0].$subtract(e),t[0].$add(e))}return new v(t[0].$subtract(i),t[0].$add(i))}static toTriangle(t,e=!0){if(e){let e=-Math.PI/2,i=2*Math.PI/3,n=new v;for(let r=0;r<3;r++)n.push(t[0].clone().toAngle(e,t[1][0],!0)),e+=i;return n}return d.fromCenter(t[0],t[1][0])}}class d{static fromRect(t){let e=t[0].$add(t[1]).divide(2);e.y=t[0][1];let i=t[1].clone();return i.x=t[0][0],new v(e,t[1].clone(),i)}static fromCircle(t){return c.toTriangle(t,!0)}static fromCenter(t,e){return d.fromCircle(c.fromCenter(t,e))}static medial(t){return t.length<3?a(new v,3):f.midpoints(t,!0)}static oppositeSide(t,e){return t.length<3?a(new v,3):0===e?v.fromPtArray([t[1],t[2]]):1===e?v.fromPtArray([t[0],t[2]]):v.fromPtArray([t[0],t[1]])}static altitude(t,e){let i=d.oppositeSide(t,e);return i.length>1?new v(t[e],h.perpendicularFromPt(i,t[e])):new v}static orthocenter(t){if(t.length<3)return a(void 0,3);let e=d.altitude(t,0),i=d.altitude(t,1);return h.intersectRay2D(e,i)}static incenter(t){if(t.length<3)return a(void 0,3);let e=f.bisector(t,0).add(t[0]),i=f.bisector(t,1).add(t[1]);return h.intersectRay2D(new v(t[0],e),new v(t[1],i))}static incircle(t,e){let i=e||d.incenter(t),n=2*f.area(t)/f.perimeter(t,!0).total;return c.fromCenter(i,n)}static circumcenter(t){let e=d.medial(t),i=[e[0],g.perpendicular(t[0].$subtract(e[0])).p1.$add(e[0])],n=[e[1],g.perpendicular(t[1].$subtract(e[1])).p1.$add(e[1])];return h.intersectRay2D(i,n)}static circumcircle(t,e){let i=e||d.circumcenter(t),n=t[0].$subtract(i).magnitude();return c.fromCenter(i,n)}}class f{static centroid(t){return g.centroid(t)}static rectangle(t,e,i){return u.corners(u.fromCenter(t,e,i))}static fromCenter(t,e,i){let n=new v;for(let r=0;r<i;r++){let s=2*Math.PI*r/i;n.push(new y(Math.cos(s)*e,Math.sin(s)*e).add(t))}return n}static lineAt(t,e){if(e<0||e>=t.length)throw new Error("index out of the Polygon's range");return new v(t[e],e===t.length-1?t[0]:t[e+1])}static lines(t,e=!0){if(t.length<2)return a(new v,2);let i=r.split(t,2,1);return e&&i.push(new v(t[t.length-1],t[0])),i.map(t=>t)}static midpoints(t,e=!1,i=.5){if(t.length<2)return a(new v,2);return f.lines(t,e).map(t=>g.interpolate(t[0],t[1],i))}static adjacentSides(t,e,i=!1){if(t.length<2)return a(new v,2);if(e<0||e>=t.length)return l(new v,e);let n=[],r=e-1;i&&r<0&&(r=t.length-1),r>=0&&n.push(new v(t[e],t[r]));let s=e+1;return i&&s>t.length-1&&(s=0),s<=t.length-1&&n.push(new v(t[e],t[s])),n}static bisector(t,e){let i=f.adjacentSides(t,e,!0);if(i.length>=2){let t=i[0][1].$subtract(i[0][0]).unit(),e=i[1][1].$subtract(i[1][0]).unit();return t.add(e).divide(2)}}static perimeter(t,e=!1){if(t.length<2)return a(new v,2);let i=f.lines(t,e),n=0,r=y.make(i.length,0);for(let t=0,e=i.length;t<e;t++){let e=h.magnitude(i[t]);n+=e,r[t]=e}return{total:n,segments:r}}static area(t){if(t.length<3)return a(new v,3);let e=(t,e)=>t[0]*e[1]-t[1]*e[0],i=0;for(let n=0,r=t.length;n<r;n++)n<t.length-1?i+=e(t[n],t[n+1]):i+=e(t[n],t[0]);return Math.abs(i/2)}static convexHull(t,e=!1){if(t.length<3)return a(new v,3);e||(t=t.slice()).sort((t,e)=>t[0]-e[0]);let i=(t,e,i)=>(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])>0,n=[],r=t.length-2,s=r+3;n[r]=t[2],n[s]=t[2],i(t[0],t[1],t[2])?(n[r+1]=t[0],n[r+2]=t[1]):(n[r+1]=t[1],n[r+2]=t[0]);for(let e=3,o=t.length;e<o;e++){let o=t[e];if(!i(n[r],n[r+1],o)||!i(n[s-1],n[s],o)){for(;!i(n[r],n[r+1],o);)r+=1;for(n[r-=1]=o;!i(n[s-1],n[s],o);)s-=1;n[s+=1]=o}}let o=new v;for(let t=0;t<s-r;t++)o.push(n[r+t]);return o}static network(t,e=0){let i=[];for(let n=0,r=t.length;n<r;n++)n!=e&&i.push(new v(t[e],t[n]));return i}static nearestPt(t,e){let i=Number.MAX_VALUE,n=-1;for(let r=0,s=t.length;r<s;r++){let s=t[r].$subtract(e).magnitudeSq();s<i&&(i=s,n=r)}return n}static projectAxis(t,e){let i=e.dot(t[0]),n=new y(i,i);for(let r=1,s=t.length;r<s;r++)i=e.dot(t[r]),n=new y(Math.min(i,n[0]),Math.max(i,n[1]));return n}static _axisOverlap(t,e,i){let n=f.projectAxis(t,i),r=f.projectAxis(e,i);return n[0]<r[0]?r[0]-n[1]:n[0]-r[1]}static hasIntersectPoint(t,e){let i=!1;for(let n=0,r=t.length;n<r;n++){let r=f.lineAt(t,n);r[0][1]>e[1]!=r[1][1]>e[1]&&e[0]<(r[1][0]-r[0][0])*(e[1]-r[0][1])/(r[1][1]-r[0][1])+r[0][0]&&(i=!i)}return i}static hasIntersectCircle(t,e){let i={which:-1,dist:0,normal:null,edge:null,vertex:null},n=e[0],r=e[1][0],s=Number.MAX_SAFE_INTEGER;for(let o=0,a=t.length;o<a;o++){let a=f.lineAt(t,o),l=new y(a[0].y-a[1].y,a[1].x-a[0].x).unit(),d=new v(n.$add(l.$multiply(r)),n.$subtract(l.$multiply(r))),p=f._axisOverlap(t,d,l);if(p>0)return null;if(Math.abs(p)<s){(u.withinBound(a,h.perpendicularFromPt(a,n))||c.intersectLine2D(e,a).length>0)&&(i.edge=a,i.normal=l,s=Math.abs(p),i.which=o)}}return i.edge?(n.$subtract(f.centroid(t)).dot(i.normal)<0&&i.normal.multiply(-1),i.dist=s,i.vertex=n,i):null}static hasIntersectPolygon(t,e){let i={which:-1,dist:0,normal:new y,edge:new v,vertex:new y},n=Number.MAX_SAFE_INTEGER;for(let r=0,s=t.length+e.length;r<s;r++){let s=r<t.length?f.lineAt(t,r):f.lineAt(e,r-t.length),o=new y(s[0].y-s[1].y,s[1].x-s[0].x).unit(),a=f._axisOverlap(t,e,o);if(a>0)return null;Math.abs(a)<n&&(i.edge=s,i.normal=o,n=Math.abs(a),i.which=r<t.length?0:1)}i.dist=n;let r=0===i.which?e:t,s=0===i.which?t:e,o=f.centroid(r),a=f.centroid(s);o.$subtract(a).dot(i.normal)<0&&i.normal.multiply(-1);let l=Number.MAX_SAFE_INTEGER;for(let t=0,e=r.length;t<e;t++){let e=i.normal.dot(r[t].$subtract(a));e<l&&(l=e,i.vertex=r[t])}return i}static intersectPolygon2D(t,e){let i=f.lines(t),n=[];for(let t=0,r=i.length;t<r;t++){let r=h.intersectPolygon2D(i[t],e,!1);r&&n.push(r)}return r.flatten(n,!0)}static toRects(t){let e=t.map(t=>g.boundingBox(t)),i=r.flatten(e,!1);return e.unshift(g.boundingBox(i)),e}}class p{static equals(t,e,i=1e-5){return Math.abs(t-e)<i}static lerp(t,e,i){return(1-i)*t+i*e}static clamp(t,e,i){return Math.max(e,Math.min(i,t))}static boundValue(t,e,i){let n=Math.abs(i-e),r=t%n;return r>i?r-=n:r<e&&(r+=n),r}static within(t,e,i){return t>=Math.min(e,i)&&t<=Math.max(e,i)}static randomRange(t,e=0){let i=t>e?t-e:e-t;return t+Math.random()*i}static normalizeValue(t,e,i){let n=Math.min(e,i);return(t-n)/(Math.max(e,i)-n)}static sum(t){let e=new y(t[0]);for(let i=1,n=t.length;i<n;i++)s.add(e,t[i]);return e}static average(t){return p.sum(t).divide(t.length)}static cycle(t){return(Math.sin(2*Math.PI*t)+1)/2}static mapToRange(t,e,i,n,r){if(e==i)throw new Error("[currMin, currMax] must define a range that is not zero");let s=Math.min(n,r),o=Math.max(n,r);return p.normalizeValue(t,e,i)*(o-s)+s}}class g{static boundAngle(t){return p.boundValue(t,0,360)}static boundRadian(t){return p.boundValue(t,0,n.two_pi)}static toRadian(t){return t*n.deg_to_rad}static toDegree(t){return t*n.rad_to_deg}static boundingBox(t){let e=t.reduce((t,e)=>t.$min(e)),i=t.reduce((t,e)=>t.$max(e));return new v(e,i)}static centroid(t){return p.average(t)}static anchor(t,e=0,i="to"){let n="to"==i?"subtract":"add";for(let i=0,r=t.length;i<r;i++)"number"==typeof e?e!==i&&t[i][n](t[e]):t[i][n](e)}static interpolate(t,e,i=.5){let n=Math.min(t.length,e.length),r=y.make(n);for(let s=0;s<n;s++)r[s]=t[s]*(1-i)+e[s]*i;return r}static perpendicular(t,e=n.xy){let i=e[1],r=e[0],s=new y(t),o=new y(s);o[r]=-s[i],o[i]=s[r];let a=new y(s);return a[r]=s[i],a[i]=-s[r],new v(o,a)}static isPerpendicular(t,e){return 0===new y(t).dot(e)}static withinBound(t,e,i){for(let n=0,r=Math.min(t.length,e.length,i.length);n<r;n++)if(!p.within(t[n],e[n],i[n]))return!1;return!0}static sortEdges(t){let e=g.boundingBox(t),i=e[1].add(e[0]).divide(2);return t.sort((t,e)=>{if(t.length<2||e.length<2)throw new Error("Pt dimension cannot be less than 2");let n=t.$subtract(i),r=e.$subtract(i);if(n[0]>=0&&r[0]<0)return 1;if(n[0]<0&&r[0]>=0)return-1;if(0==n[0]&&0==r[0])return n[1]>=0||r[1]>=0?n[1]>r[1]?1:-1:r[1]>n[1]?1:-1;let s=n.$cross2D(r);return s<0?1:s>0?-1:n[0]*n[0]+n[1]*n[1]>r[0]*r[0]+r[1]*r[1]?1:-1})}static scale(t,e,i){let n=Array.isArray(t)?t:[t],r="number"==typeof e?y.make(n[0].length,e):e;i||(i=y.make(n[0].length,0));for(let t=0,e=n.length;t<e;t++){let e=n[t];for(let t=0,n=e.length;t<n;t++)e[t]=i&&i[t]?i[t]+(e[t]-i[t])*r[t]:e[t]*r[t]}return g}static rotate2D(t,e,i,n){let r=Array.isArray(t)?t:[t],s=i?o.rotateAt2DMatrix:o.rotate2DMatrix;i||(i=y.make(r[0].length,0));let a=Math.cos(e),l=Math.sin(e);for(let t=0,e=r.length;t<e;t++){let e=n?r[t].$take(n):r[t];e.to(o.transform2D(e,s(a,l,i)))}return g}static shear2D(t,e,i,n){let r=Array.isArray(t)?t:[t],s="number"==typeof e?[e,e]:e;i||(i=y.make(r[0].length,0));let a=i?o.shearAt2DMatrix:o.shear2DMatrix,l=Math.tan(s[0]),h=Math.tan(s[1]);for(let t=0,e=r.length;t<e;t++){let e=n?r[t].$take(n):r[t];e.to(o.transform2D(e,a(l,h,i)))}return g}static reflect2D(t,e,i){let n=Array.isArray(t)?t:[t],r=o.reflectAt2DMatrix(e[0],e[1]);for(let t=0,e=n.length;t<e;t++){let e=i?n[t].$take(i):n[t];e.to(o.transform2D(e,r))}return g}static cosTable(){let t=new Float64Array(360);for(let e=0;e<360;e++)t[e]=Math.cos(e*Math.PI/180);return{table:t,cos:e=>t[Math.floor(g.boundAngle(g.toDegree(e)))]}}static sinTable(){let t=new Float64Array(360);for(let e=0;e<360;e++)t[e]=Math.sin(e*Math.PI/180);return{table:t,sin:e=>t[Math.floor(g.boundAngle(g.toDegree(e)))]}}}var m,_=Float32Array;class y extends _{constructor(...t){1===t.length&&"number"==typeof t[0]?super(t[0]):super(t.length>0?r.getArgs(t):[0,0])}static make(t,e=0,i=!1){let n=new _(t);if(e&&n.fill(e),i)for(let t=0,e=n.length;t<e;t++)n[t]=n[t]*Math.random();return new y(n)}get id(){return this._id}set id(t){this._id=t}get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}get w(){return this[3]}set w(t){this[3]=t}clone(){return new y(this)}equals(t,e=1e-6){for(let i=0,n=this.length;i<n;i++)if(Math.abs(this[i]-t[i])>e)return!1;return!0}to(...t){let e=r.getArgs(t);for(let t=0,i=Math.min(this.length,e.length);t<i;t++)this[t]=e[t];return this}$to(...t){return this.clone().to(...t)}toAngle(t,e,i=!1){let n=null!=e?e:this.magnitude(),r=[Math.cos(t)*n,Math.sin(t)*n];return i?this.add(r):this.to(r)}op(t){let e=this;return(...i)=>t(e,...i)}ops(t){let e=[];for(let i=0,n=t.length;i<n;i++)e.push(this.op(t[i]));return e}$take(t){let e=[];for(let i=0,n=t.length;i<n;i++)e.push(this[t[i]]||0);return new y(e)}$concat(...t){return new y(this.toArray().concat(r.getArgs(t)))}add(...t){return 1===t.length&&"number"==typeof t[0]?s.add(this,t[0]):s.add(this,r.getArgs(t)),this}$add(...t){return this.clone().add(...t)}subtract(...t){return 1===t.length&&"number"==typeof t[0]?s.subtract(this,t[0]):s.subtract(this,r.getArgs(t)),this}$subtract(...t){return this.clone().subtract(...t)}multiply(...t){return 1===t.length&&"number"==typeof t[0]?s.multiply(this,t[0]):s.multiply(this,r.getArgs(t)),this}$multiply(...t){return this.clone().multiply(...t)}divide(...t){return 1===t.length&&"number"==typeof t[0]?s.divide(this,t[0]):s.divide(this,r.getArgs(t)),this}$divide(...t){return this.clone().divide(...t)}magnitudeSq(){return s.dot(this,this)}magnitude(){return s.magnitude(this)}unit(t){return s.unit(this,t),this}$unit(t){return this.clone().unit(t)}dot(...t){return s.dot(this,r.getArgs(t))}$cross2D(...t){return s.cross2D(this,r.getArgs(t))}$cross(...t){return s.cross(this,r.getArgs(t))}$project(...t){return this.$multiply(this.dot(...t)/this.magnitudeSq())}projectScalar(...t){return this.dot(...t)/this.magnitude()}abs(){return s.abs(this),this}$abs(){return this.clone().abs()}floor(){return s.floor(this),this}$floor(){return this.clone().floor()}ceil(){return s.ceil(this),this}$ceil(){return this.clone().ceil()}round(){return s.round(this),this}$round(){return this.clone().round()}minValue(){return s.min(this)}maxValue(){return s.max(this)}$min(...t){let e=r.getArgs(t),i=this.clone();for(let t=0,n=Math.min(this.length,e.length);t<n;t++)i[t]=Math.min(this[t],e[t]);return i}$max(...t){let e=r.getArgs(t),i=this.clone();for(let t=0,n=Math.min(this.length,e.length);t<n;t++)i[t]=Math.max(this[t],e[t]);return i}angle(t=n.xy){return Math.atan2(this[t[1]],this[t[0]])}angleBetween(t,e=n.xy){return g.boundRadian(this.angle(e))-g.boundRadian(t.angle(e))}scale(t,e){return g.scale(this,t,e||y.make(this.length,0)),this}rotate2D(t,e,i){return g.rotate2D(this,t,e||y.make(this.length,0),i),this}shear2D(t,e,i){return g.shear2D(this,t,e||y.make(this.length,0),i),this}reflect2D(t,e){return g.reflect2D(this,t,e),this}toString(){return`Pt(${this.join(", ")})`}toArray(){return[].slice.call(this)}}class v extends Array{constructor(...t){super(...t)}get id(){return this._id}set id(t){this._id=t}get p1(){return this[0]}get p2(){return this[1]}get p3(){return this[2]}get p4(){return this[3]}get q1(){return this[this.length-1]}get q2(){return this[this.length-2]}get q3(){return this[this.length-3]}get q4(){return this[this.length-4]}clone(){let t=new v;for(let e=0,i=this.length;e<i;e++)t.push(this[e].clone());return t}static fromArray(t){let e=new v;for(let i=0,n=t.length;i<n;i++){let n=t[i]instanceof y?t[i]:new y(t[i]);e.push(n)}return e}static fromPtArray(t){return v.from(t)}split(t,e,i=!1){return r.split(this,t,e,i)}insert(t,e=0){return v.prototype.splice.apply(this,[e,0,...t]),this}remove(t=0,e=1){let i=t<0?[-1*t-1,e]:[t,e];return v.prototype.splice.apply(this,i)}segments(t=2,e=1,i=!1){return this.split(t,e,i)}lines(){return this.segments(2,1)}centroid(){return g.centroid(this)}boundingBox(){return g.boundingBox(this)}anchorTo(t=0){g.anchor(this,t,"to")}anchorFrom(t=0){g.anchor(this,t,"from")}op(t){let e=this;return(...i)=>t(e,...i)}ops(t){let e=[];for(let i=0,n=t.length;i<n;i++)e.push(this.op(t[i]));return e}interpolate(t){t=p.clamp(t,0,1);let e=this.length-1,i=1/(this.length-1),n=Math.floor(t/i);return g.interpolate(this[n],this[Math.min(this.length-1,n+1)],(t-n*i)*e)}moveBy(...t){return this.add(...t)}moveTo(...t){let e=new y(r.getArgs(t)).subtract(this[0]);return this.moveBy(e),this}scale(t,e){for(let i=0,n=this.length;i<n;i++)g.scale(this[i],t,e||this[0]);return this}rotate2D(t,e,i){for(let n=0,r=this.length;n<r;n++)g.rotate2D(this[n],t,e||this[0],i);return this}shear2D(t,e,i){for(let n=0,r=this.length;n<r;n++)g.shear2D(this[n],t,e||this[0],i);return this}reflect2D(t,e){for(let i=0,n=this.length;i<n;i++)g.reflect2D(this[i],t,e);return this}sortByDimension(t,e=!1){return this.sort((i,n)=>e?n[t]-i[t]:i[t]-n[t])}forEachPt(t,...e){if(!this[0][t])return r.warn(`${t} is not a function of Pt`),this;for(let i=0,n=this.length;i<n;i++)this[i]=this[i][t](...e);return this}add(...t){return this.forEachPt("add",...t)}subtract(...t){return this.forEachPt("subtract",...t)}multiply(...t){return this.forEachPt("multiply",...t)}divide(...t){return this.forEachPt("divide",...t)}$matrixAdd(t){return o.add(this,t)}$matrixMultiply(t,e=!1,i=!1){return o.multiply(this,t,e,i)}zipSlice(t,e=!1){return o.zipSlice(this,t,e)}$zip(t,e=!1){return o.zip(this,t,e)}toString(){return"Group[ "+this.reduce((t,e)=>t+e.toString()+" ","")+" ]"}}class b extends v{constructor(...t){super(...t),this._center=new y,this._size=new y,this._topLeft=new y,this._bottomRight=new y,this._inited=!1,this.init()}static fromBoundingRect(t){let e=new b(new y(t.left||0,t.top||0),new y(t.right||0,t.bottom||0));return t.width&&t.height&&(e.size=new y(t.width,t.height)),e}static fromGroup(t){if(t.length<2)throw new Error("Cannot create a Bound from a group that has less than 2 Pt");return new b(t[0],t[t.length-1])}init(){if(this.p1&&(this._size=this.p1.clone(),this._inited=!0),this.p1&&this.p2){let t=this.p1,e=this.p2;this.topLeft=t.$min(e),this._bottomRight=t.$max(e),this._updateSize(),this._inited=!0}}clone(){return new b(this._topLeft.clone(),this._bottomRight.clone())}_updateSize(){this._size=this._bottomRight.$subtract(this._topLeft).abs(),this._updateCenter()}_updateCenter(){this._center=this._size.$multiply(.5).add(this._topLeft)}_updatePosFromTop(){this._bottomRight=this._topLeft.$add(this._size),this._updateCenter()}_updatePosFromBottom(){this._topLeft=this._bottomRight.$subtract(this._size),this._updateCenter()}_updatePosFromCenter(){let t=this._size.$multiply(.5);this._topLeft=this._center.$subtract(t),this._bottomRight=this._center.$add(t)}get size(){return new y(this._size)}set size(t){this._size=new y(t),this._updatePosFromTop()}get center(){return new y(this._center)}set center(t){this._center=new y(t),this._updatePosFromCenter()}get topLeft(){return new y(this._topLeft)}set topLeft(t){this._topLeft=new y(t),this[0]=this._topLeft,this._updateSize()}get bottomRight(){return new y(this._bottomRight)}set bottomRight(t){this._bottomRight=new y(t),this[1]=this._bottomRight,this._updateSize()}get width(){return this._size.length>0?this._size.x:0}set width(t){this._size.x=t,this._updatePosFromTop()}get height(){return this._size.length>1?this._size.y:0}set height(t){this._size.y=t,this._updatePosFromTop()}get depth(){return this._size.length>2?this._size.z:0}set depth(t){this._size.z=t,this._updatePosFromTop()}get x(){return this.topLeft.x}get y(){return this.topLeft.y}get z(){return this.topLeft.z}get inited(){return this._inited}update(){return this._topLeft=this[0],this._bottomRight=this[1],this._updateSize(),this}}!function(t){t[t.Rectangle=0]="Rectangle",t[t.Circle=1]="Circle",t[t.Polygon=2]="Polygon",t[t.Polyline=3]="Polyline",t[t.Line=4]="Line"}(m||(m={}));const w={up:"up",down:"down",move:"move",drag:"drag",drop:"drop",over:"over",out:"out"};class x{constructor(){this.id="space",this.bound=new b,this._time={prev:0,diff:0,end:-1},this.players={},this.playerCount=0,this._animID=-1,this._pause=!1,this._refresh=void 0,this._pointer=new y,this._isReady=!1,this._playing=!1}refresh(t){return this._refresh=t,this}add(t){let e="function"==typeof t?{animate:t}:t,i=this.playerCount++,n=this.id+i;return this.players[n]=e,e.animateID=n,e.resize&&this.bound.inited&&e.resize(this.bound),void 0===this._refresh&&(this._refresh=!0),this}remove(t){return delete this.players[t.animateID],this}removeAll(){return this.players={},this}play(t=0){if(this._animID=requestAnimationFrame(this.play.bind(this)),this._pause)return this;this._time.diff=t-this._time.prev,this._time.prev=t;try{this.playItems(t)}catch(t){throw cancelAnimationFrame(this._animID),this._playing=!1,t}return this}replay(){this._time.end=-1,this.play()}playItems(t){if(this._playing=!0,this._refresh&&this.clear(),this._isReady)for(let e in this.players)this.players[e].animate&&this.players[e].animate(t,this._time.diff,this);this._time.end>=0&&t>this._time.end&&(cancelAnimationFrame(this._animID),this._playing=!1)}pause(t=!1){return this._pause=!t||!this._pause,this}resume(){return this._pause=!1,this}stop(t=0){return this._time.end=t,this}playOnce(t=5e3){return this.play(),this.stop(t),this}render(t){return this._renderFunc&&this._renderFunc(t,this),this}set customRendering(t){this._renderFunc=t}get customRendering(){return this._renderFunc}get isPlaying(){return this._playing}get outerBound(){return this.bound.clone()}get innerBound(){return new b(y.make(this.size.length,0),this.size.clone())}get size(){return this.bound.size.clone()}get center(){return this.size.divide(2)}get width(){return this.bound.width}get height(){return this.bound.height}}class $ extends x{constructor(){super(...arguments),this._pressed=!1,this._dragged=!1,this._hasMouse=!1,this._hasTouch=!1}get pointer(){let t=this._pointer.clone();return t.id=this._pointer.id,t}bindCanvas(t,e){this._canvas.addEventListener(t,e)}unbindCanvas(t,e){this._canvas.removeEventListener(t,e)}bindMouse(t=!0){return t?(this.bindCanvas("mousedown",this._mouseDown.bind(this)),this.bindCanvas("mouseup",this._mouseUp.bind(this)),this.bindCanvas("mouseover",this._mouseOver.bind(this)),this.bindCanvas("mouseout",this._mouseOut.bind(this)),this.bindCanvas("mousemove",this._mouseMove.bind(this)),this._hasMouse=!0):(this.unbindCanvas("mousedown",this._mouseDown.bind(this)),this.unbindCanvas("mouseup",this._mouseUp.bind(this)),this.unbindCanvas("mouseover",this._mouseOver.bind(this)),this.unbindCanvas("mouseout",this._mouseOut.bind(this)),this.unbindCanvas("mousemove",this._mouseMove.bind(this)),this._hasMouse=!1),this}bindTouch(t=!0){return t?(this.bindCanvas("touchstart",this._mouseDown.bind(this)),this.bindCanvas("touchend",this._mouseUp.bind(this)),this.bindCanvas("touchmove",this._touchMove.bind(this)),this.bindCanvas("touchcancel",this._mouseOut.bind(this)),this._hasTouch=!0):(this.unbindCanvas("touchstart",this._mouseDown.bind(this)),this.unbindCanvas("touchend",this._mouseUp.bind(this)),this.unbindCanvas("touchmove",this._touchMove.bind(this)),this.unbindCanvas("touchcancel",this._mouseOut.bind(this)),this._hasTouch=!1),this}touchesToPoints(t,e="touches"){if(!t||!t[e])return[];let i=[];for(var n=0;n<t[e].length;n++){let r=t[e].item(n);i.push(new y(r.pageX-this.bound.topLeft.x,r.pageY-this.bound.topLeft.y))}return i}_mouseAction(t,e){let i=0,n=0;if(e instanceof MouseEvent){for(let r in this.players)if(this.players.hasOwnProperty(r)){let s=this.players[r];i=e.pageX-this.outerBound.x,n=e.pageY-this.outerBound.y,s.action&&s.action(t,i,n,e)}}else for(let r in this.players)if(this.players.hasOwnProperty(r)){let s=this.players[r],o=e.changedTouches&&e.changedTouches.length>0,a=e.changedTouches.item(0);i=o?a.pageX-this.outerBound.x:0,n=o?a.pageY-this.outerBound.y:0,s.action&&s.action(t,i,n,e)}t&&(this._pointer.to(i,n),this._pointer.id=t)}_mouseDown(t){return this._mouseAction(w.down,t),this._pressed=!0,!1}_mouseUp(t){return this._mouseAction(w.up,t),this._dragged&&this._mouseAction(w.down,t),this._pressed=!1,this._dragged=!1,!1}_mouseMove(t){return this._mouseAction(w.move,t),this._pressed&&(this._dragged=!0,this._mouseAction(w.drag,t)),!1}_mouseOver(t){return this._mouseAction(w.over,t),!1}_mouseOut(t){return this._mouseAction(w.out,t),this._dragged&&this._mouseAction(w.drop,t),this._dragged=!1,!1}_touchMove(t){return this._mouseMove(t),t.preventDefault(),!1}}class M{constructor(){this._ready=!1}get ready(){return this._ready}static _checkSize(t,e=2){return!(t.length<e)||(r.warn("Requires 2 or more Pts in this Group."),!1)}}class z extends M{constructor(){super(...arguments),this._filled=!0,this._stroked=!0,this._font=new D(14,"sans-serif")}get filled(){return this._filled}set filled(t){this._filled=t}get stroked(){return this._stroked}set stroked(t){this._stroked=t}get currentFont(){return this._font}_multiple(t,e,...i){if(!t)return this;for(let n=0,r=t.length;n<r;n++)this[e](t[n],...i);return this}fill(t){return this}fillOnly(t){return this.stroke(!1),this.fill(t)}stroke(t,e,i,n){return this}strokeOnly(t,e,i,n){return this.fill(!1),this.stroke(t,e,i,n)}points(t,e,i){if(t){for(let n=0,r=t.length;n<r;n++)this.point(t[n],e,i);return this}}circles(t){return this._multiple(t,"circle")}squares(t){return this._multiple(t,"square")}lines(t){return this._multiple(t,"line")}polygons(t){return this._multiple(t,"polygon")}rects(t){return this._multiple(t,"rect")}}class D{constructor(t=12,e="sans-serif",i="",n="",r=1.5){this.size=t,this.face=e,this.style=n,this.weight=i,this.lineHeight=r}get value(){return`${this.style} ${this.weight} ${this.size}px/${this.lineHeight} ${this.face}`}toString(){return this.value}}class A{static textWidthEstimator(t,e=["M","n","."],i=[.06,.8,.14]){let n=e.map(t),r=new y(i).dot(n);return t=>t.length*r}static truncate(t,e,i,n=""){let r=Math.floor(e.length*Math.min(1,i/t(e)));return r<e.length?(r=Math.max(0,r-n.length),[e.substr(0,r)+n,r]):[e,e.length]}static fontSizeToBox(t,e=1,i=!0){let n=i?1:0,r=t[1][n]-t[0][n],s=e*r;return function(t){let e=(t[1][n]-t[0][n])/r;return s*e}}static fontSizeToThreshold(t,e=0){return function(i,n){let r=i*n/t;return e<0?Math.min(r,i):e>0?Math.max(r,i):r}}}class C extends ${constructor(t,e){super(),this._pixelScale=1,this._autoResize=!0,this._bgcolor="#e1e9f0",this._offscreen=!1,this._initialResize=!1;var i=null;if(this.id="pt",t instanceof Element)i=t,this.id="pts_existing_space";else{let e=t;e="#"===t[0]||"."===t[0]?t:"#"+t,i=document.querySelector(e),!0,this.id=e.substr(1)}i?"canvas"!=i.nodeName.toLowerCase()?(this._container=i,this._canvas=this._createElement("canvas",this.id+"_canvas"),this._container.appendChild(this._canvas),this._initialResize=!0):(this._canvas=i,this._container=i.parentElement,this._autoResize=!1):(this._container=this._createElement("div",this.id+"_container"),this._canvas=this._createElement("canvas",this.id),this._container.appendChild(this._canvas),document.body.appendChild(this._container)),setTimeout(this._ready.bind(this,e),100),this._ctx=this._canvas.getContext("2d")}_createElement(t="div",e){let i=document.createElement(t);return i.setAttribute("id",e),i}_ready(t){if(!this._container)throw new Error(`Cannot initiate #${this.id} element`);this._isReady=!0,this._resizeHandler(null),this.clear(this._bgcolor),this._canvas.dispatchEvent(new Event("ready"));for(let t in this.players)this.players.hasOwnProperty(t)&&this.players[t].start&&this.players[t].start(this.bound.clone(),this);this._pointer=this.center,this._initialResize=!1,t&&t(this.bound,this._canvas)}setup(t){if(t.bgcolor&&(this._bgcolor=t.bgcolor),this.autoResize=null!=t.resize&&t.resize,!1!==t.retina){let t=window.devicePixelRatio||1,e=this._ctx.webkitBackingStorePixelRatio||this._ctx.mozBackingStorePixelRatio||this._ctx.msBackingStorePixelRatio||this._ctx.oBackingStorePixelRatio||this._ctx.backingStorePixelRatio||1;this._pixelScale=Math.max(1,t/e)}return t.offscreen?(this._offscreen=!0,this._offCanvas=this._createElement("canvas",this.id+"_offscreen"),this._offCtx=this._offCanvas.getContext("2d")):this._offscreen=!1,this}set autoResize(t){this._autoResize=t,t?window.addEventListener("resize",this._resizeHandler.bind(this)):window.removeEventListener("resize",this._resizeHandler.bind(this))}get autoResize(){return this._autoResize}resize(t,e){this.bound=t,this._canvas.width=this.bound.size.x*this._pixelScale,this._canvas.height=this.bound.size.y*this._pixelScale,this._canvas.style.width=Math.floor(this.bound.size.x)+"px",this._canvas.style.height=Math.floor(this.bound.size.y)+"px",this._offscreen&&(this._offCanvas.width=this.bound.size.x*this._pixelScale,this._offCanvas.height=this.bound.size.y*this._pixelScale),1!=this._pixelScale&&(this._ctx.scale(this._pixelScale,this._pixelScale),this._ctx.translate(.5,.5),this._offscreen&&(this._offCtx.scale(this._pixelScale,this._pixelScale),this._offCtx.translate(.5,.5)));for(let t in this.players)if(this.players.hasOwnProperty(t)){let i=this.players[t];i.resize&&i.resize(this.bound,e)}return this.render(this._ctx),e&&!this.isPlaying&&this.playOnce(0),this}_resizeHandler(t){let e=this._autoResize||this._initialResize?this._container.getBoundingClientRect():this._canvas.getBoundingClientRect();if(e){let i=b.fromBoundingRect(e);i.center=i.center.add(window.pageXOffset,window.pageYOffset),this.resize(i,t)}}set background(t){this._bgcolor=t}get background(){return this._bgcolor}get pixelScale(){return this._pixelScale}get hasOffscreen(){return this._offscreen}get offscreenCtx(){return this._offCtx}get offscreenCanvas(){return this._offCanvas}getForm(){return new S(this)}get element(){return this._canvas}get parent(){return this._container}get ready(){return this._isReady}get ctx(){return this._ctx}clear(t){t&&(this._bgcolor=t);let e=this._ctx.fillStyle;return this._bgcolor&&"transparent"!=this._bgcolor?(this._ctx.fillStyle=this._bgcolor,this._ctx.fillRect(-1,-1,this._canvas.width+1,this._canvas.height+1)):this._ctx.clearRect(-1,-1,this._canvas.width+1,this._canvas.height+1),this._ctx.fillStyle=e,this}clearOffscreen(t){return this._offscreen&&(t?(this._offCtx.fillStyle=t,this._offCtx.fillRect(-1,-1,this._canvas.width+1,this._canvas.height+1)):this._offCtx.clearRect(-1,-1,this._offCanvas.width+1,this._offCanvas.height+1)),this}playItems(t){this._isReady&&(this._ctx.save(),this._offscreen&&this._offCtx.save(),super.playItems(t),this._ctx.restore(),this._offscreen&&this._offCtx.restore(),this.render(this._ctx))}}class S extends z{constructor(t){super(),this._style={fillStyle:"#f03",strokeStyle:"#fff",lineWidth:1,lineJoin:"bevel",lineCap:"butt"},this._space=t,this._space.add({start:()=>{this._ctx=this._space.ctx,this._ctx.fillStyle=this._style.fillStyle,this._ctx.strokeStyle=this._style.strokeStyle,this._ctx.lineJoin="bevel",this._ctx.font=this._font.value,this._ready=!0}})}get space(){return this._space}useOffscreen(t=!0,e=!1){return e&&this._space.clearOffscreen("string"==typeof e?e:null),this._ctx=this._space.hasOffscreen&&t?this._space.offscreenCtx:this._space.ctx,this}renderOffscreen(t=[0,0]){this._space.hasOffscreen&&this._space.ctx.drawImage(this._space.offscreenCanvas,t[0],t[1],this._space.width,this._space.height)}fill(t){return"boolean"==typeof t?this.filled=t:(this.filled=!0,this._style.fillStyle=t,this._ctx.fillStyle=t),this}stroke(t,e,i,n){return"boolean"==typeof t?this.stroked=t:(this.stroked=!0,this._style.strokeStyle=t,this._ctx.strokeStyle=t,e&&(this._ctx.lineWidth=e,this._style.lineWidth=e),i&&(this._ctx.lineJoin=i,this._style.lineJoin=i),n&&(this._ctx.lineCap=n,this._style.lineCap=n)),this}font(t,e,i,n,r){return"number"==typeof t?(this._font.size=t,r&&(this._font.face=r),e&&(this._font.weight=e),i&&(this._font.style=i),n&&(this._font.lineHeight=n),this._ctx.font=this._font.value):this._font=t,this._estimateTextWidth&&this.fontWidthEstimate(!0),this}fontWidthEstimate(t=!0){return this._estimateTextWidth=t?A.textWidthEstimator(t=>this._ctx.measureText(t).width):void 0,this}getTextWidth(t){return this._estimateTextWidth?this._estimateTextWidth(t):this._ctx.measureText(t+" .").width}_textTruncate(t,e,i=""){return A.truncate(this.getTextWidth.bind(this),t,e,i)}_textAlign(t,e,i,n){n||(n=u.center(t));var r=t[0][0];"end"==this._ctx.textAlign||"right"==this._ctx.textAlign?r=t[1][0]:"center"!=this._ctx.textAlign&&"middle"!=this._ctx.textAlign||(r=n[0]);var s=n[1];return"top"==e||"start"==e?s=t[0][1]:"end"!=e&&"bottom"!=e||(s=t[1][1]),i?new y(r+i[0],s+i[1]):new y(r,s)}reset(){for(let t in this._style)this._style.hasOwnProperty(t)&&(this._ctx[t]=this._style[t]);return this._font=new D,this._ctx.font=this._font.value,this}_paint(){this._filled&&this._ctx.fill(),this._stroked&&this._ctx.stroke()}point(t,e=5,i="square"){if(t){if(!S[i])throw new Error(`${i} is not a static function of CanvasForm`);return S[i](this._ctx,t,e),this._paint(),this}}static circle(t,e,i=10){e&&(t.beginPath(),t.arc(e[0],e[1],i,0,n.two_pi,!1),t.closePath())}circle(t){return S.circle(this._ctx,t[0],t[1][0]),this._paint(),this}static arc(t,e,i,n,r,s){e&&(t.beginPath(),t.arc(e[0],e[1],i,n,r,s))}arc(t,e,i,n,r){return S.arc(this._ctx,t,e,i,n,r),this._paint(),this}static square(t,e,i){if(!e)return;let n=e[0]-i,r=e[1]-i,s=e[0]+i,o=e[1]+i;t.beginPath(),t.moveTo(n,r),t.lineTo(n,o),t.lineTo(s,o),t.lineTo(s,r),t.closePath()}square(t,e){return S.square(this._ctx,t,e),this._paint(),this}static line(t,e){if(!(e.length<2)){t.beginPath(),t.moveTo(e[0][0],e[0][1]);for(let i=1,n=e.length;i<n;i++)e[i]&&t.lineTo(e[i][0],e[i][1])}}line(t){return S.line(this._ctx,t),this._paint(),this}static polygon(t,e){if(!(e.length<2)){t.beginPath(),t.moveTo(e[0][0],e[0][1]);for(let i=1,n=e.length;i<n;i++)e[i]&&t.lineTo(e[i][0],e[i][1]);t.closePath()}}polygon(t){return S.polygon(this._ctx,t),this._paint(),this}static rect(t,e){e.length<2||(t.beginPath(),t.moveTo(e[0][0],e[0][1]),t.lineTo(e[0][0],e[1][1]),t.lineTo(e[1][0],e[1][1]),t.lineTo(e[1][0],e[0][1]),t.closePath())}rect(t){return S.rect(this._ctx,t),this._paint(),this}static image(t,e,i=new y,n){if("number"==typeof i[0])t.drawImage(e,i[0],i[1]);else{let r=i;n?t.drawImage(e,n[0][0],n[0][1],n[1][0]-n[0][0],n[1][1]-n[0][1],r[0][0],r[0][1],r[1][0]-r[0][0],r[1][1]-r[0][1]):t.drawImage(e,r[0][0],r[0][1],r[1][0]-r[0][0],r[1][1]-r[0][1])}}image(t,e,i){return S.image(this._ctx,t,e,i),this}static text(t,e,i,n){e&&t.fillText(i,e[0],e[1],n)}text(t,e,i){return S.text(this._ctx,t,e,i),this}textBox(t,e,i="middle",n="",r=!0){r&&(this._ctx.textBaseline=i);let s=u.size(t),o=this._textTruncate(e,s[0],n);return this.text(this._textAlign(t,i),o[0]),this}paragraphBox(t,e,i=1.2,n="top",r=!0){let s=u.size(t);this._ctx.textBaseline="top";let o=this._font.size*i,a=(t,e=[],i=0)=>{if(!t)return e;if(r&&i*o>s[1]-2*o)return e;if(i>1e4)throw new Error("max recursion reached (10000)");let n=this._textTruncate(t,s[0],""),l=n[0].indexOf("\n");if(l>=0)return e.push(n[0].substr(0,l)),a(t.substr(l+1),e,i+1);let h=n[0].lastIndexOf(" ")+1;(h<=0||n[1]===t.length)&&(h=void 0);let u=n[0].substr(0,h);return e.push(u),n[1]<=0||n[1]===t.length?e:a(t.substr(h||n[1]),e,i+1)},l=a(e),h=l.length*o,c=t;if("middle"==n||"center"==n){let e=(s[1]-h)/2;r&&(e=Math.max(0,e)),c=new v(t[0].$add(0,e),t[1].$subtract(0,e))}else c="bottom"==n?new v(t[0].$add(0,s[1]-h),t[1]):new v(t[0],t[0].$add(s[0],h));let d=u.center(c);for(let t=0,e=l.length;t<e;t++)this.text(this._textAlign(c,"top",[0,t*o],d),l[t]);return this}alignText(t="left",e="alphabetic"){return"center"==e&&(e="middle"),"baseline"==e&&(e="alphabetic"),this._ctx.textAlign=t,this._ctx.textBaseline=e,this}log(t){let e=this._ctx.measureText(t).width+20;return this.stroke(!1).fill("rgba(0,0,0,.4)").rect([[0,0],[e,20]]),this.fill("#fff").text([10,14],t),this}}class E{static distributeRandom(t,e,i=2){let n=new v;for(let r=0;r<e;r++){let e=[t.x+Math.random()*t.width];i>1&&e.push(t.y+Math.random()*t.height),i>2&&e.push(t.z+Math.random()*t.depth),n.push(new y(e))}return n}static distributeLinear(t,e){let i=h.subpoints(t,e-2);return i.unshift(t[0]),i.push(t[t.length-1]),i}static gridPts(t,e,i,n=[.5,.5]){if(0===e||0===i)throw new Error("grid columns and rows cannot be 0");let r=t.size.$subtract(1).$divide(e,i),s=r.$multiply(n),o=new v;for(let n=0;n<i;n++)for(let i=0;i<e;i++)o.push(t.topLeft.$add(r.$multiply(i,n)).add(s));return o}static gridCells(t,e,i){if(0===e||0===i)throw new Error("grid columns and rows cannot be 0");let n=t.size.$subtract(1).divide(e,i),r=[];for(let s=0;s<i;s++)for(let i=0;i<e;i++)r.push(new v(t.topLeft.$add(n.$multiply(i,s)),t.topLeft.$add(n.$multiply(i,s).add(n))));return r}static radialPts(t,e,i){let r=new v,s=n.two_pi/i;for(let o=0;o<i;o++)r.push(new y(t).toAngle(s*o-n.half_pi,e,!0));return r}static noisePts(t,e=.01,i=.01,n=0,r=0){let s=Math.random(),o=new v;for(let a=0,l=t.length;a<l;a++){let l=new P(t[a]),h=n&&n>0?Math.floor(a/n):a,u=r&&r>0?a%r:a;l.initNoise(e*u,i*h),l.seed(s),o.push(l)}return o}static delaunay(t){return I.from(t)}}const k=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],R=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,9,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];class P extends y{constructor(...t){super(...t),this.perm=[],this._n=new y(.01,.01),this.perm=R.concat(R)}initNoise(...t){this._n=new y(...t)}step(t=0,e=0){this._n.add(t,e)}seed(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(let e=0;e<255;e++){let i=1&e?R[e]^255&t:R[e]^t>>8&255;this.perm[e]=this.perm[e+256]=i}}noise2D(){let t=Math.max(0,Math.floor(this._n[0]))%255,e=Math.max(0,Math.floor(this._n[1]))%255,i=this._n[0]%255-t,n=this._n[1]%255-e,r=s.dot(k[(t+this.perm[e])%12],[i,n,0]),o=s.dot(k[(t+this.perm[e+1])%12],[i,n-1,0]),a=s.dot(k[(t+1+this.perm[e])%12],[i-1,n,0]),l=s.dot(k[(t+1+this.perm[e+1])%12],[i-1,n-1,0]),h=t=>t*t*t*(t*(6*t-15)+10),u=h(i);return p.lerp(p.lerp(r,a,u),p.lerp(o,l,u),h(n))}}class I extends v{constructor(){super(...arguments),this._mesh=[]}delaunay(t=!0){if(this.length<3)return[];this._mesh=[];let e=this.length,i=[];for(let t=0;t<e;t++)i[t]=t;i.sort((t,e)=>this[e][0]-this[t][0]);let r=this.slice(),s=this._superTriangle();r=r.concat(s);let o=[this._circum(e,e+1,e+2,s)],a=[],l=[];for(let t=0,e=i.length;t<e;t++){let e=i[t],s=[],h=o.length;for(this._mesh[e]||(this._mesh[e]={});h--;){let t=o[h],i=t.circle[1][0],u=r[e].$subtract(t.circle[0]);u[0]>0&&u[0]*u[0]>i*i?(a.push(t),l.push(t.triangle),o.splice(h,1)):u[0]*u[0]+u[1]*u[1]-i*i>n.epsilon||(s.push(t.i,t.j,t.j,t.k,t.k,t.i),o.splice(h,1))}for(I._dedupe(s),h=s.length;h>1;)o.push(this._circum(s[--h],s[--h],e,!1,r))}for(let t=0,i=o.length;t<i;t++){let i=o[t];i.i<e&&i.j<e&&i.k<e&&(a.push(i),l.push(i.triangle),this._cache(i))}return t?l:a}voronoi(){let t=[];for(let e=0,i=this._mesh.length;e<i;e++)t.push(this.neighborPts(e,!0));return t}mesh(){return this._mesh}neighborPts(t,e=!1){let i=new v,n=this._mesh;for(let e in n[t])n[t].hasOwnProperty(e)&&i.push(n[t][e].circle[0]);return e?g.sortEdges(i):i}neighbors(t){let e=[],i=this._mesh;for(let n in i[t])i[t].hasOwnProperty(n)&&e.push(i[t][n]);return e}_cache(t){this._mesh[t.i][`${Math.min(t.j,t.k)}-${Math.max(t.j,t.k)}`]=t,this._mesh[t.j][`${Math.min(t.i,t.k)}-${Math.max(t.i,t.k)}`]=t,this._mesh[t.k][`${Math.min(t.i,t.j)}-${Math.max(t.i,t.j)}`]=t}_superTriangle(){let t=this[0],e=this[0];for(let i=1,n=this.length;i<n;i++)t=t.$min(this[i]),e=e.$max(this[i]);let i=e.$subtract(t),n=t.$add(e).divide(2),r=Math.max(i[0],i[1]);return new v(n.$subtract(20*r,r),n.$add(0,20*r),n.$add(20*r,-r))}_triangle(t,e,i,n=this){return new v(n[t],n[e],n[i])}_circum(t,e,i,n,r=this){let s=n||this._triangle(t,e,i,r);return{i:t,j:e,k:i,triangle:s,circle:d.circumcircle(s)}}static _dedupe(t){let e=t.length;for(;e>1;){let i=t[--e],n=t[--e],r=e;for(;r>1;){let s=t[--r],o=t[--r];if(n==o&&i==s||n==s&&i==o){t.splice(e,2),t.splice(r,2);break}}}return t}}class T extends y{constructor(...t){super(...t),this._mode="rgb",this._isNorm=!1}static from(...t){let e=[1,1,1,1],i=r.getArgs(t);for(let t=0,n=e.length;t<n;t++)t<i.length&&(e[t]=i[t]);return new T(e)}static fromHex(t){if("#"==t[0]&&(t=t.substr(1)),t.length<=3){let e=e=>t[e]||"F";t=`${e(0)}${e(0)}${e(1)}${e(1)}${e(2)}${e(2)}`}let e=1;8===t.length&&(e=t.substr(6)&&1,t=t.substring(0,6));let i=parseInt(t,16);return new T(i>>16,i>>8&255,255&i,e)}static rgb(...t){return T.from(...t).toMode("rgb")}static hsl(...t){return T.from(...t).toMode("hsl")}static hsb(...t){return T.from(...t).toMode("hsb")}static lab(...t){return T.from(...t).toMode("lab")}static lch(...t){return T.from(...t).toMode("lch")}static luv(...t){return T.from(...t).toMode("luv")}static xyz(...t){return T.from(...t).toMode("xyz")}static maxValues(t){return T.ranges[t].zipSlice(1).$take([0,1,2])}get hex(){return this.toString("hex")}get rgb(){return this.toString("rgb")}get rgba(){return this.toString("rgba")}clone(){let t=new T(this);return t.toMode(this._mode),t}toMode(t,e=!1){if(e){let e=this._mode.toUpperCase()+"to"+t.toUpperCase();if(!T[e])throw new Error("Cannot convert color with "+e);this.to(T[e](this,this._isNorm,this._isNorm))}return this._mode=t,this}get mode(){return this._mode}get r(){return this[0]}set r(t){this[0]=t}get g(){return this[1]}set g(t){this[1]=t}get b(){return this[2]}set b(t){this[2]=t}get h(){return"lch"==this._mode?this[2]:this[0]}set h(t){this["lch"==this._mode?2:0]=t}get s(){return this[1]}set s(t){this[1]=t}get l(){return"hsl"==this._mode?this[2]:this[0]}set l(t){this["hsl"==this._mode?2:0]=t}get a(){return this[1]}set a(t){this[1]=t}get c(){return this[1]}set c(t){this[1]=t}get u(){return this[1]}set u(t){this[1]=t}get v(){return this[2]}set v(t){this[2]=t}get alpha(){return this.length>3?this[3]:1}get normalized(){return this._isNorm}set normalized(t){this._isNorm=t}normalize(t=!0){if(this._isNorm==t)return this;let e=T.ranges[this._mode];for(let i=0;i<3;i++)this[i]=t?p.mapToRange(this[i],e[i][0],e[i][1],0,1):p.mapToRange(this[i],0,1,e[i][0],e[i][1]);return this._isNorm=t,this}$normalize(t=!0){return this.clone().normalize(t)}toString(t="mode"){if("hex"==t){let t=t=>{let e=Math.floor(t).toString(16);return e.length<2?"0"+e:e};return`#${t(this[0])}${t(this[1])}${t(this[2])}`}return"rgba"==t?`rgba(${Math.floor(this[0])},${Math.floor(this[1])},${Math.floor(this[2])},${this.alpha}`:"rgb"==t?`rgb(${Math.floor(this[0])},${Math.floor(this[1])},${Math.floor(this[2])}`:`${this._mode}(${this[0]},${this[1]},${this[2]},${this.alpha})`}static RGBtoHSL(t,e=!1,i=!1){let[n,r,s]=e?t:t.$normalize(),o=Math.max(n,r,s),a=Math.min(n,r,s),l=(o+a)/2,h=l,u=l;if(o==a)l=0,h=0;else{let t=o-a;h=u>.5?t/(2-o-a):t/(o+a),l=0,o===n?l=(r-s)/t+(r<s?6:0):o===r?l=(s-n)/t+2:o===s&&(l=(n-r)/t+4)}return T.hsl(i?l/60:60*l,h,u,t.alpha)}static HSLtoRGB(t,e=!1,i=!1){let[n,r,s]=t;if(e||(n/=360),0==r)return T.rgb(255*s,255*s,255*s,t.alpha);let o=s<=.5?s*(1+r):s+r-s*r,a=2*s-o,l=t=>6*(t=t<0?t+1:t>1?t-1:t)<1?a+(o-a)*t*6:2*t<1?o:3*t<2?a+(o-a)*(2/3-t)*6:a,h=i?1:255;return T.rgb(h*l(n+1/3),h*l(n),h*l(n-1/3),t.alpha)}static RGBtoHSB(t,e=!1,i=!1){let[n,r,s]=e?t:t.$normalize(),o=Math.max(n,r,s),a=Math.min(n,r,s),l=o-a,h=0,u=0===o?0:l/o,c=o;return o!=a&&(o===n?h=(r-s)/l+(r<s?6:0):o===r?h=(s-n)/l+2:o===s&&(h=(n-r)/l+4)),T.hsb(i?h/60:60*h,u,c,t.alpha)}static HSBtoRGB(t,e=!1,i=!1){let[n,r,s]=t;e||(n/=360);let o=Math.floor(6*n),a=6*n-o,l=s*(1-r),h=s*(1-a*r),u=s*(1-(1-a)*r),c=[[s,u,l],[h,s,l],[l,s,u],[l,h,s],[u,l,s],[s,l,h]][o%6],d=i?1:255;return T.rgb(d*c[0],d*c[1],d*c[2],t.alpha)}static RGBtoLAB(t,e=!1,i=!1){let n=e?t.$normalize(!1):t;return T.XYZtoLAB(T.RGBtoXYZ(n),!1,i)}static LABtoRGB(t,e=!1,i=!1){let n=e?t.$normalize(!1):t;return T.XYZtoRGB(T.LABtoXYZ(n),!1,i)}static RGBtoLCH(t,e=!1,i=!1){let n=e?t.$normalize(!1):t;return T.LABtoLCH(T.RGBtoLAB(n),!1,i)}static LCHtoRGB(t,e=!1,i=!1){let n=e?t.$normalize(!1):t;return T.LABtoRGB(T.LCHtoLAB(n),!1,i)}static RGBtoLUV(t,e=!1,i=!1){let n=e?t.$normalize(!1):t;return T.XYZtoLUV(T.RGBtoXYZ(n),!1,i)}static LUVtoRGB(t,e=!1,i=!1){let n=e?t.$normalize(!1):t;return T.XYZtoRGB(T.LUVtoXYZ(n),!1,i)}static RGBtoXYZ(t,e=!1,i=!1){let n=e?t.clone():t.$normalize();for(let t=0;t<3;t++)n[t]=n[t]>.04045?Math.pow((n[t]+.055)/1.055,2.4):n[t]/12.92,i||(n[t]=100*n[t]);let r=T.xyz(.4124564*n[0]+.3575761*n[1]+.1804375*n[2],.2126729*n[0]+.7151522*n[1]+.072175*n[2],.0193339*n[0]+.119192*n[1]+.9503041*n[2],t.alpha);return i?r.normalize():r}static XYZtoRGB(t,e=!1,i=!1){let[n,r,s]=e?t:t.$normalize(),o=[3.2404542*n+-1.5371385*r+-.4985314*s,-.969266*n+1.8760108*r+.041556*s,.0556434*n+-.2040259*r+1.0572252*s];for(let t=0;t<3;t++)o[t]=o[t]<0?0:o[t]>.0031308?1.055*Math.pow(o[t],1/2.4)-.055:12.92*o[t],o[t]=Math.max(0,Math.min(1,o[t])),i||(o[t]=Math.round(255*o[t]));let a=T.rgb(o[0],o[1],o[2],t.alpha);return i?a.normalize():a}static XYZtoLAB(t,e=!1,i=!1){let n=e?t.$normalize(!1):t.clone();n.divide(T.D65);let r=t=>t>.008856?Math.pow(t,1/3):7.787*t+16/116,s=r(n[1]),o=T.lab(116*s-16,500*(r(n[0])-s),200*(s-r(n[2])),t.alpha);return i?o.normalize():o}static LABtoXYZ(t,e=!1,i=!1){let n=e?t.$normalize(!1):t,r=(n[0]+16)/116,s=n[1]/500+r,o=r-n[2]/200,a=t=>{let e=t*t*t;return e>.008856?e:(t-16/116)/7.787},l=T.D65,h=T.xyz(Math.max(0,l[0]*a(s)),Math.max(0,l[1]*a(r)),Math.max(0,l[2]*a(o)),t.alpha);return i?h.normalize():h}static XYZtoLUV(t,e=!1,i=!1){let[n,r,s]=e?t.$normalize(!1):t,o=4*n/(n+15*r+3*s),a=9*r/(n+15*r+3*s);r=(r/=100)>.008856?Math.pow(r,1/3):7.787*r+16/116;let l=4*T.D65[0]/(T.D65[0]+15*T.D65[1]+3*T.D65[2]),h=9*T.D65[1]/(T.D65[0]+15*T.D65[1]+3*T.D65[2]),u=116*r-16;return T.luv(u,13*u*(o-l),13*u*(a-h),t.alpha)}static LUVtoXYZ(t,e=!1,i=!1){let[n,r,s]=e?t.$normalize(!1):t,o=(n+16)/116,a=o*o*o;o=a>.008856?a:(o-16/116)/7.787;let l=9*(o*=100)*(r=r/(13*n)+4*T.D65[0]/(T.D65[0]+15*T.D65[1]+3*T.D65[2]))*-1/((r-4)*(s=s/(13*n)+9*T.D65[1]/(T.D65[0]+15*T.D65[1]+3*T.D65[2]))-r*s),h=(9*o-15*s*o-s*l)/(3*s);return T.xyz(l,o,h,t.alpha)}static LABtoLCH(t,e=!1,i=!1){let n=e?t.$normalize(!1):t,r=g.toDegree(g.boundRadian(Math.atan2(n[2],n[1])));return T.lch(n[0],Math.sqrt(n[1]*n[1]+n[2]*n[2]),r,t.alpha)}static LCHtoLAB(t,e=!1,i=!1){let n=e?t.$normalize(!1):t,r=g.toRadian(n[2]);return T.lab(n[0],Math.cos(r)*n[1],Math.sin(r)*n[1],t.alpha)}}T.D65=new y(95.047,100,108.883,1),T.ranges={rgb:new v(new y(0,255),new y(0,255),new y(0,255)),hsl:new v(new y(0,360),new y(0,1),new y(0,1)),hsb:new v(new y(0,360),new y(0,1),new y(0,1)),lab:new v(new y(0,100),new y(-128,127),new y(-128,127)),lch:new v(new y(0,100),new y(0,100),new y(0,360)),luv:new v(new y(0,100),new y(-134,220),new y(-140,122)),xyz:new v(new y(0,100),new y(0,100),new y(0,100))};class L extends ${constructor(t,e){super(),this.id="domspace",this._autoResize=!0,this._bgcolor="#e1e9f0",this._css={};var i=null;this.id="pts",t instanceof Element?(i=t,this.id="pts_existing_space"):(i=document.querySelector(t),!0,this.id=t.substr(1)),i?(this._canvas=i,this._container=i.parentElement):(this._container=L.createElement("div","pts_container"),this._canvas=L.createElement("div","pts_element"),this._container.appendChild(this._canvas),document.body.appendChild(this._container)),setTimeout(this._ready.bind(this,e),50)}static createElement(t="div",e,i){let n=document.createElement(t);return e&&n.setAttribute("id",e),i&&i.appendChild&&i.appendChild(n),n}_ready(t){if(!this._container)throw new Error(`Cannot initiate #${this.id} element`);this._isReady=!0,this._resizeHandler(null),this.clear(this._bgcolor),this._canvas.dispatchEvent(new Event("ready"));for(let t in this.players)this.players.hasOwnProperty(t)&&this.players[t].start&&this.players[t].start(this.bound.clone(),this);this._pointer=this.center,this.refresh(!1),t&&t(this.bound,this._canvas)}setup(t){return t.bgcolor&&(this._bgcolor=t.bgcolor),this.autoResize=null!=t.resize&&t.resize,this}getForm(){return null}set autoResize(t){this._autoResize=t,t?window.addEventListener("resize",this._resizeHandler.bind(this)):(delete this._css.width,delete this._css.height,window.removeEventListener("resize",this._resizeHandler.bind(this)))}get autoResize(){return this._autoResize}resize(t,e){this.bound=t,this.styles({width:`${t.width}px`,height:`${t.height}px`},!0);for(let t in this.players)if(this.players.hasOwnProperty(t)){let i=this.players[t];i.resize&&i.resize(this.bound,e)}return this}_resizeHandler(t){let e=b.fromBoundingRect(this._container.getBoundingClientRect());this._autoResize?this.styles({width:"100%",height:"100%"},!0):this.styles({width:`${e.width}px`,height:`${e.height}px`},!0),this.resize(e,t)}get element(){return this._canvas}get parent(){return this._container}get ready(){return this._isReady}clear(t){return t&&(this.background=t),this._canvas.innerHTML="",this}set background(t){this._bgcolor=t,this._container.style.backgroundColor=this._bgcolor}get background(){return this._bgcolor}style(t,e,i=!1){return this._css[t]=e,i&&(this._canvas.style[t]=e),this}styles(t,e=!1){for(let i in t)t.hasOwnProperty(i)&&this.style(i,t[i],e);return this}static setAttr(t,e){for(let i in e)e.hasOwnProperty(i)&&t.setAttribute(i,e[i]);return t}static getInlineStyles(t){let e="";for(let i in t)t.hasOwnProperty(i)&&t[i]&&(e+=`${i}: ${t[i]}; `);return e}}class O extends L{getForm(){return new B(this)}static htmlElement(t,e,i,n=!0){if(!t||!t.appendChild)throw new Error("parent is not a valid DOM element");let r=document.querySelector(`#${i}`);return r||((r=document.createElement(e)).setAttribute("id",i),n&&r.setAttribute("class",i.substring(0,i.indexOf("-"))),t.appendChild(r)),r}remove(t){return this._container.querySelectorAll("."+B.scopeID(t)).forEach(t=>{t.parentNode.removeChild(t)}),super.remove(t)}removeAll(){return this._container.innerHTML="",super.removeAll()}}class B extends z{constructor(t){super(),this._ctx={group:null,groupID:"pts",groupCount:0,currentID:"pts0",currentClass:"",style:{filled:!0,stroked:!0,background:"#f03","border-color":"#fff",color:"#000","border-width":"1px","border-radius":"0","border-style":"solid",position:"absolute",top:0,left:0,width:0,height:0},font:"11px sans-serif",fontSize:11,fontFamily:"sans-serif"},this._ready=!1,this._space=t,this._space.add({start:()=>{this._ctx.group=this._space.element,this._ctx.groupID="pts_dom_"+B.groupID++,this._ready=!0}})}get space(){return this._space}styleTo(t,e,i=""){if(void 0===this._ctx.style[t])throw new Error(`${t} style property doesn't exist`);this._ctx.style[t]=`${e}${i}`}fill(t){return"boolean"==typeof t?(this.styleTo("filled",t),t||this.styleTo("background","transparent")):(this.styleTo("filled",!0),this.styleTo("background",t)),this}stroke(t,e,i,n){return"boolean"==typeof t?(this.styleTo("stroked",t),t||this.styleTo("border-width",0)):(this.styleTo("stroked",!0),this.styleTo("border-color",t),this.styleTo("border-width",(e||1)+"px")),this}fillText(t){return this.styleTo("color",t),this}cls(t){return this._ctx.currentClass="boolean"==typeof t?"":t,this}font(t,e,i,n,r){return"number"==typeof t?(this._font.size=t,r&&(this._font.face=r),e&&(this._font.weight=e),i&&(this._font.style=i),n&&(this._font.lineHeight=n),this._ctx.font=this._font.value):this._font=t,this}reset(){return this._ctx.style={filled:!0,stroked:!0,background:"#f03","border-color":"#fff","border-width":"1px"},this._font=new D(14,"sans-serif"),this._ctx.font=this._font.value,this}updateScope(t,e){return this._ctx.group=e,this._ctx.groupID=t,this._ctx.groupCount=0,this.nextID(),this._ctx}scope(t){if(!t||null==t.animateID)throw new Error("item not defined or not yet added to Space");return this.updateScope(B.scopeID(t),this.space.element)}nextID(){return this._ctx.groupCount++,this._ctx.currentID=`${this._ctx.groupID}-${this._ctx.groupCount}`,this._ctx.currentID}static getID(t){return t.currentID||`p-${B.domID++}`}static scopeID(t){return`item-${t.animateID}`}static style(t,e){let i=[];e.filled||i.push("background: none"),e.stroked||i.push("border: none");for(let t in e)if(e.hasOwnProperty(t)&&"filled"!=t&&"stroked"!=t){let n=e[t];if(n){if(!e.filled&&0===t.indexOf("background"))continue;if(!e.stroked&&0===t.indexOf("border-width"))continue;i.push(`${t}: ${n}`)}}return O.setAttr(t,{style:i.join(";")})}static rectStyle(t,e,i){return t.style.left=e[0]+"px",t.style.top=e[1]+"px",t.style.width=i[0]+"px",t.style.height=i[1]+"px",t}static point(t,e,i=5,n="square"){return"circle"===n?B.circle(t,e,i):B.square(t,e,i)}point(t,e=5,i="square"){return this.nextID(),"circle"==i&&this.styleTo("border-radius","100%"),B.point(this._ctx,t,e,i),this}static circle(t,e,i=10){let n=O.htmlElement(t.group,"div",B.getID(t));return O.setAttr(n,{class:`pts-form pts-circle ${t.currentClass}`}),B.rectStyle(t,new y(e).$subtract(i),new y(2*i,2*i)),B.style(n,t.style),n}circle(t){return this.nextID(),this.styleTo("border-radius","100%"),B.circle(this._ctx,t[0],t[1][0]),this}static square(t,e,i){let n=O.htmlElement(t.group,"div",B.getID(t));return O.setAttr(n,{class:`pts-form pts-square ${t.currentClass}`}),B.rectStyle(t,new y(e).$subtract(i),new y(2*i,2*i)),B.style(n,t.style),n}square(t,e){return this.nextID(),B.square(this._ctx,t,e),this}static rect(t,e){if(!this._checkSize(e))return;let i=O.htmlElement(t.group,"div",B.getID(t));return O.setAttr(i,{class:`pts-form pts-rect ${t.currentClass}`}),B.rectStyle(t,e[0],e[1]),B.style(i,t.style),i}rect(t){return this.nextID(),this.styleTo("border-radius","0"),B.rect(this._ctx,t),this}static text(t,e,i){let n=O.htmlElement(t.group,"div",B.getID(t));return O.setAttr(n,{position:"absolute",class:`pts-form pts-text ${t.currentClass}`,left:e[0],top:e[1]}),n.textContent=i,B.style(n,t.style),n}text(t,e){return this.nextID(),B.text(this._ctx,t,e),this}log(t){return this.fill("#000").stroke("#fff",.5).text([10,14],t),this}arc(t,e,i,n,s){return r.warn("arc is not implemented in HTMLForm"),this}line(t){return r.warn("line is not implemented in HTMLForm"),this}polygon(t){return r.warn("polygon is not implemented in HTMLForm"),this}}B.groupID=0,B.domID=0;class j extends L{constructor(t,e){if(super(t,e),this.id="svgspace",this._bgcolor="#999","svg"!=this._canvas.nodeName.toLowerCase()){let t=j.svgElement(this._canvas,"svg",`${this.id}_svg`);this._container=this._canvas,this._canvas=t}}getForm(){return new q(this)}get element(){return this._canvas}resize(t,e){return super.resize(t,e),j.setAttr(this.element,{viewBox:`0 0 ${this.bound.width} ${this.bound.height}`,width:`${this.bound.width}`,height:`${this.bound.height}`,xmlns:"http://www.w3.org/2000/svg",version:"1.1"}),this}static svgElement(t,e,i){if(!t||!t.appendChild)throw new Error("parent is not a valid DOM element");let n=document.querySelector(`#${i}`);return n||((n=document.createElementNS("http://www.w3.org/2000/svg",e)).setAttribute("id",i),t.appendChild(n)),n}remove(t){return this._container.querySelectorAll("."+q.scopeID(t)).forEach(t=>{t.parentNode.removeChild(t)}),super.remove(t)}removeAll(){return this._container.innerHTML="",super.removeAll()}}class q extends z{constructor(t){super(),this._ctx={group:null,groupID:"pts",groupCount:0,currentID:"pts0",currentClass:"",style:{filled:!0,stroked:!0,fill:"#f03",stroke:"#fff","stroke-width":1,"stroke-linejoin":"bevel","stroke-linecap":"sqaure"},font:"11px sans-serif",fontSize:11,fontFamily:"sans-serif"},this._ready=!1,this._space=t,this._space.add({start:()=>{this._ctx.group=this._space.element,this._ctx.groupID="pts_svg_"+q.groupID++,this._ready=!0}})}get space(){return this._space}styleTo(t,e){if(void 0===this._ctx.style[t])throw new Error(`${t} style property doesn't exist`);this._ctx.style[t]=e}fill(t){return"boolean"==typeof t?this.styleTo("filled",t):(this.styleTo("filled",!0),this.styleTo("fill",t)),this}stroke(t,e,i,n){return"boolean"==typeof t?this.styleTo("stroked",t):(this.styleTo("stroked",!0),this.styleTo("stroke",t),e&&this.styleTo("stroke-width",e),i&&this.styleTo("stroke-linejoin",i),n&&this.styleTo("stroke-linecap",n)),this}cls(t){return this._ctx.currentClass="boolean"==typeof t?"":t,this}font(t,e,i,n,r){return"number"==typeof t?(this._font.size=t,r&&(this._font.face=r),e&&(this._font.weight=e),i&&(this._font.style=i),n&&(this._font.lineHeight=n),this._ctx.font=this._font.value):this._font=t,this}reset(){return this._ctx.style={filled:!0,stroked:!0,fill:"#f03",stroke:"#fff","stroke-width":1,"stroke-linejoin":"bevel","stroke-linecap":"sqaure"},this._font=new D(14,"sans-serif"),this._ctx.font=this._font.value,this}updateScope(t,e){return this._ctx.group=e,this._ctx.groupID=t,this._ctx.groupCount=0,this.nextID(),this._ctx}scope(t){if(!t||null==t.animateID)throw new Error("item not defined or not yet added to Space");return this.updateScope(q.scopeID(t),this.space.element)}nextID(){return this._ctx.groupCount++,this._ctx.currentID=`${this._ctx.groupID}-${this._ctx.groupCount}`,this._ctx.currentID}static getID(t){return t.currentID||`p-${q.domID++}`}static scopeID(t){return`item-${t.animateID}`}static style(t,e){let i=[];e.filled||i.push("fill: none"),e.stroked||i.push("stroke: none");for(let t in e)if(e.hasOwnProperty(t)&&"filled"!=t&&"stroked"!=t){let n=e[t];if(n){if(!e.filled&&0===t.indexOf("fill"))continue;if(!e.stroked&&0===t.indexOf("stroke"))continue;i.push(`${t}: ${n}`)}}return L.setAttr(t,{style:i.join(";")})}static point(t,e,i=5,n="square"){return"circle"===n?q.circle(t,e,i):q.square(t,e,i)}point(t,e=5,i="square"){return this.nextID(),q.point(this._ctx,t,e,i),this}static circle(t,e,i=10){let n=j.svgElement(t.group,"circle",q.getID(t));return L.setAttr(n,{cx:e[0],cy:e[1],r:i,class:`pts-svgform pts-circle ${t.currentClass}`}),q.style(n,t.style),n}circle(t){return this.nextID(),q.circle(this._ctx,t[0],t[1][0]),this}static arc(t,e,i,r,s,o){let a=j.svgElement(t.group,"path",q.getID(t));const l=new y(e).toAngle(r,i,!0),h=new y(e).toAngle(s,i,!0);let u=g.boundAngle(s)-g.boundAngle(r)>n.pi;o&&(u=!u);const c=o?"0":"1",d=`M ${l[0]} ${l[1]} A ${i} ${i} 0 ${u?"1":"0"} ${c} ${h[0]} ${h[1]}`;return L.setAttr(a,{d:d,class:`pts-svgform pts-arc ${t.currentClass}`}),q.style(a,t.style),a}arc(t,e,i,n,r){return this.nextID(),q.arc(this._ctx,t,e,i,n,r),this}static square(t,e,i){let n=j.svgElement(t.group,"rect",q.getID(t));return L.setAttr(n,{x:e[0]-i,y:e[1]-i,width:2*i,height:2*i,class:`pts-svgform pts-square ${t.currentClass}`}),q.style(n,t.style),n}square(t,e){return this.nextID(),q.square(this._ctx,t,e),this}static line(t,e){if(!this._checkSize(e))return;if(e.length>2)return q._poly(t,e,!1);let i=j.svgElement(t.group,"line",q.getID(t));return L.setAttr(i,{x1:e[0][0],y1:e[0][1],x2:e[1][0],y2:e[1][1],class:`pts-svgform pts-line ${t.currentClass}`}),q.style(i,t.style),i}line(t){return this.nextID(),q.line(this._ctx,t),this}static _poly(t,e,i=!0){if(!this._checkSize(e))return;let n=j.svgElement(t.group,i?"polygon":"polyline",q.getID(t)),r=e.reduce((t,e)=>t+`${e[0]},${e[1]} `,"");return L.setAttr(n,{points:r,class:`pts-svgform pts-polygon ${t.currentClass}`}),q.style(n,t.style),n}static polygon(t,e){return q._poly(t,e,!0)}polygon(t){return this.nextID(),q.polygon(this._ctx,t),this}static rect(t,e){if(!this._checkSize(e))return;let i=j.svgElement(t.group,"rect",q.getID(t)),n=v.fromArray(e).boundingBox(),r=u.size(n);return L.setAttr(i,{x:n[0][0],y:n[0][1],width:r[0],height:r[1],class:`pts-svgform pts-rect ${t.currentClass}`}),q.style(i,t.style),i}rect(t){return this.nextID(),q.rect(this._ctx,t),this}static text(t,e,i){let n=j.svgElement(t.group,"text",q.getID(t));return L.setAttr(n,{"pointer-events":"none",x:e[0],y:e[1],dx:0,dy:0,class:`pts-svgform pts-text ${t.currentClass}`}),n.textContent=i,q.style(n,t.style),n}text(t,e){return this.nextID(),q.text(this._ctx,t,e),this}log(t){return this.fill("#000").stroke("#fff",.5).text([10,14],t),this}}q.groupID=0,q.domID=0;class H{constructor(t,e=1,i=0){return this._lastTime=null,this._gravity=new y,this._friction=1,this._damping=.75,this._particles=[],this._bodies=[],this._names={p:{},b:{}},this._bound=b.fromGroup(t),this._friction=e,this._gravity="number"==typeof i?new y(0,i):new y(i),this}get gravity(){return this._gravity}set gravity(t){this._gravity=t}get friction(){return this._friction}set friction(t){this._friction=t}get damping(){return this._damping}set damping(t){this._damping=t}get bodyCount(){return this._bodies.length}get particleCount(){return this._particles.length}body(t){return this._bodies["string"==typeof t?this._names.b[t]:t]}particle(t){return this._particles["string"==typeof t?this._names.p[t]:t]}update(t){let e=t/1e3;this._updateParticles(e),this._updateBodies(e)}drawParticles(t){this._drawParticles=t}drawBodies(t){this._drawBodies=t}add(t,e){return t instanceof F?(this._bodies.push(t),e&&(this._names.b[e]=this._bodies.length-1)):(this._particles.push(t),e&&(this._names.p[e]=this._particles.length-1)),this}remove(t,e,i=1){let n=e<0?[-1*e-1,i]:[e,i];return"body"==t?this._bodies.splice(n[0],n[1]):this._particles.splice(n[0],n[1]),this}static edgeConstraint(t,e,i,n=1,r=!1){const s=1/(t.mass||1),o=1/(e.mass||1),a=s+o;let l=e.$subtract(t),h=i*i,u=r?i/l.magnitude()-1:h/(l.dot(l)+h)-.5,c=l.$multiply(u*n);return t.subtract(c.$multiply(s/a)),e.add(c.$multiply(o/a)),t}static boundConstraint(t,e,i=.75){let n=e.boundingBox(),r=t.$min(n[1].subtract(t.radius)).$max(n[0].add(t.radius));if(r[0]===n[0][0]||r[0]===n[1][0]){let e=t.changed.$multiply(i);t.previous=r.$subtract(new y(-e[0],e[1]))}else if(r[1]===n[0][1]||r[1]===n[1][1]){let e=t.changed.$multiply(i);t.previous=r.$subtract(new y(e[0],-e[1]))}t.to(r)}integrate(t,e,i){return t.addForce(this._gravity),t.verlet(e,this._friction,i),t}_updateParticles(t){for(let e=0,i=this._particles.length;e<i;e++){let n=this._particles[e];this.integrate(n,t,this._lastTime),H.boundConstraint(n,this._bound,this._damping);for(let t=e+1;t<i;t++)if(e!==t){let e=this._particles[t];n.collide(e,this._damping)}this._drawParticles&&this._drawParticles(n,e)}this._lastTime=t}_updateBodies(t){for(let e=0,i=this._bodies.length;e<i;e++){let n=this._bodies[e];for(let e=0,i=n.length;e<i;e++){let i=n[e];H.boundConstraint(i,this._bound,this._damping),this.integrate(i,t,this._lastTime)}for(let t=e+1;t<i;t++)n.processBody(this._bodies[t]);for(let t=0,e=this._particles.length;t<e;t++)n.processParticle(this._particles[t]);n.processEdges(),this._drawBodies&&this._drawBodies(n,e)}}}class N extends y{constructor(...t){super(...t),this._mass=1,this._radius=0,this._force=new y,this._prev=new y,this._lock=!1,this._prev=this.clone()}get mass(){return this._mass}set mass(t){this._mass=t}get radius(){return this._radius}set radius(t){this._radius=t}get previous(){return this._prev}set previous(t){this._prev=t}get force(){return this._force}set force(t){this._force=t}get body(){return this._body}set body(t){this._body=t}get lock(){return this._lock}set lock(t){this._lock=t,this._lockPt=new y(this)}get changed(){return this.$subtract(this._prev)}set position(t){this.previous.to(this),this._lock&&(this._lockPt=t),this.to(t)}size(t){return this._mass=t,this._radius=t,this}addForce(...t){return this._force.add(...t),this._force}verlet(t,e,i){if(this._lock)this.to(this._lockPt);else{let n=i||t,r=this._force.multiply(t*(t+n)/2),s=this.changed.multiply(e*t/n).add(r);this._prev=this.clone(),this.add(s),this._force=new y}return this}hit(...t){return this._prev.subtract(new y(...t).$divide(Math.sqrt(this._mass))),this}collide(t,e=1){let i=this,n=i.$subtract(t),r=n.magnitudeSq(),s=i.radius+t.radius;if(r<s*s){let o=i.changed,a=t.changed,l=Math.sqrt(r),h=n.$multiply((l-s)/l/2),u=i.$subtract(h),c=t.$add(h);i.to(u),t.to(c);let d=e*n.dot(o)/r,f=e*n.dot(a)/r,p=i.mass/(i.mass+t.mass),g=t.mass/(i.mass+t.mass);o.add(new y(f*n[0]-d*n[0],f*n[1]-d*n[1]).$multiply(g)),a.add(new y(d*n[0]-f*n[0],d*n[1]-f*n[1]).$multiply(p)),i.previous=i.$subtract(o),t.previous=t.$subtract(a)}}toString(){return`Particle: ${this[0]} ${this[1]} | previous ${this._prev[0]} ${this._prev[1]} | mass ${this._mass}`}}class F extends v{constructor(){super(),this._cs=[],this._stiff=1,this._locks={},this._mass=1}static fromGroup(t,e=1,i=!0,n=!0){let r=(new F).init(t);return i&&r.linkAll(e),n&&r.autoMass(),r}init(t,e=1){let i=new y;for(let e=0,n=t.length;e<n;e++){let n=new N(t[e]);n.body=this,i.add(t[e]),this.push(n)}return this._stiff=e,this}get mass(){return this._mass}set mass(t){this._mass=t;for(let t=0,e=this.length;t<e;t++)this[t].mass=this._mass}autoMass(){return this.mass=Math.sqrt(f.area(this))/10,this}link(t,e,i){if(t<0||t>=this.length)throw new Error("index1 is not in the Group's indices");if(e<0||e>=this.length)throw new Error("index1 is not in the Group's indices");let n=this[t].$subtract(this[e]).magnitude();return this._cs.push([t,e,n,i||this._stiff]),this}linkAll(t){let e=this.length/2;for(let i=0,n=this.length;i<n;i++){let r=i>=n-1?0:i+1;if(this.link(i,r,t),n>4){let r=Math.floor(e/2)+1,s=i>=n-r?i%n:i+r;this.link(i,s,t)}i<=e-1&&this.link(i,Math.min(this.length-1,i+Math.floor(e)))}}linksToLines(){let t=[];for(let e=0,i=this._cs.length;e<i;e++){let i=this._cs[e];t.push(new v(this[i[0]],this[i[1]]))}return t}processEdges(){for(let t=0,e=this._cs.length;t<e;t++){let[e,i,n,r]=this._cs[t];H.edgeConstraint(this[e],this[i],n,r)}}processBody(t){let e=t,i=f.hasIntersectPolygon(this,e);if(i){let t,e=i.normal.$multiply(i.dist),n=i.edge,r=1/((t=Math.abs(n[0][0]-n[1][0])>Math.abs(n[0][1]-n[1][1])?(i.vertex[0]-e[0]-n[0][0])/(n[1][0]-n[0][0]):(i.vertex[1]-e[1]-n[0][1])/(n[1][1]-n[0][1]))*t+(1-t)*(1-t)),s=i.vertex.body.mass||1,o=i.edge[0].body.mass||1,a=s/(s+o),l=o/(s+o);n[0].subtract(e.$multiply(a*(1-t)*r/2)),n[1].subtract(e.$multiply(a*t*r/2)),i.vertex.add(e.$multiply(l))}}processParticle(t){let e=t,i=f.hasIntersectCircle(this,c.fromCenter(t,t.radius));if(i){let n,r=i.normal.$multiply(i.dist),s=i.edge,o=1/((n=Math.abs(s[0][0]-s[1][0])>Math.abs(s[0][1]-s[1][1])?(i.vertex[0]-r[0]-s[0][0])/(s[1][0]-s[0][0]):(i.vertex[1]-r[1]-s[0][1])/(s[1][1]-s[0][1]))*n+(1-n)*(1-n)),a=i.vertex.mass||e.mass||1,l=i.edge[0].body.mass||1,h=a/(a+l),u=l/(a+l);s[0].subtract(r.$multiply(h*(1-n)*o/2)),s[1].subtract(r.$multiply(h*n*o/2));let c=t.changed.add(r.$multiply(u));t.previous=t.$subtract(c)}}}i.d(e,"a",function(){return C}),i.d(e,"b",function(){return E}),i.d(e,"c",function(){return p}),i.d(e,"e",function(){return y}),i.d(e,"f",function(){return H}),i.d(e,"d",function(){return N})}}]);
//# sourceMappingURL=17-70bc596e66864aaf0f1a.js.map