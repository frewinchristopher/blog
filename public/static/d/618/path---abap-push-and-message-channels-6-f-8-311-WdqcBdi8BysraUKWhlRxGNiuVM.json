{"data":{"site":{"siteMetadata":{"title":"Chris Frewin's Full Stack Blog.","author":"Chris Frewin"}},"markdownRemark":{"id":"c1c7ac29-b184-5fc6-a1b7-4f1a659ad325","excerpt":"Add some spice to your SAPUI5 apps! (Or even normal webapps, for that matter) I was a noob. I wrote in my SAPUI5 some warehouse task codeâ€¦","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Add some spice to your SAPUI5 apps!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"(Or even normal webapps, for that matter)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I was a noob. I wrote in my SAPUI5 some warehouse task code that would have a real time. How did I do it?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I wrote a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"window.setInterval()"}]},{"type":"text","value":" function that would ping table "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/SCWM/WT"}]},{"type":"text","value":" ðŸ˜Š and check for any new lines - with an OData "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"GET_ENTITY_SET"}]},{"type":"text","value":" server request. ðŸ˜Š ðŸ˜Š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Yeah."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Well, I was lucky to learn about websockets from one of our EWM. Then I was even luckier to learn a bit more about the technical aspects (when to subscribe, unsubscribe, destroy, and create websockets instances from actions on the front end)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So hereâ€™s how to add websockets to your SAPUI5 app"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#footnote-1"},"children":[{"type":"text","value":"1"}]}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Transactions"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"All backend push and messaging channels can be managed with just two transactions:  "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SAMC"}]},{"type":"text","value":", for message channels and "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SAPC"}]},{"type":"text","value":", for push channels. Easy enough."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Creating a Message Channel"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As we will see, to create a proper push channel, we will first need a message channel, so that is where we start off. An ABAP message channel is a way of subscribing current programs to any - the best thing about push channels is that if the push channel "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"isnâ€™t"}]},{"type":"text","value":" listening, there is no error and nothing else negative happens anywhere else in the system - that is, granted you "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"TRY"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CATCH"}]},{"type":"text","value":" your push channel messaging properly."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So letâ€™s get started in transaction "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SAMC"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":""},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We define the message channel name, and, most importantly, define what programs can use this message channel and what type of message this channel will handle (there are only 2 - numeric and string)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now, as I mention before, we use these channels to hook into any ABAP program, so that any time they are executed by anyone (or anything) in the system, the channel will be messages. A safe way to hook into an existing program (using our newly created "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Z_AWESOME_CHANNEL"}]},{"type":"text","value":") looks as follows:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"]},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"pre","properties":{"className":["language-abap"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-abap"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"REPORT"}]},{"type":"text","value":" my_super_cool_existing_report"}]}]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Creating a Push Channel"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ok, now we head to transaction "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SAPC"}]},{"type":"text","value":" - we are no going to define a websocket that will be hooked up to our push channel. That way, when something happens in our program, it will message to all subscribed channels, which will be forwarded , and then ultimately, to the most important part, the frontend for our user to see!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Frontend"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"On the frontend I create a general websocket function that creates a websocket instance. In order to have the correct service for each view, upon each view change I call this function, which always creates a new instance if there exists a websocket instance already. This way we are sure that on any view change, we have a fresh running instance of the websocket doing the correct task for this view."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"That function looks like this:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"]},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[]}]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note that you of course have to us "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ws://"}]},{"type":"text","value":" as the protocol in the link name!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"On the backend, that ends up looking like a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CASE"}]},{"type":"text","value":" statement:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"]},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"pre","properties":{"className":["language-abap"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-abap"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"CASE"}]}]}]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Code"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Yep, youâ€™re going to have to write some ABAP code too. Luckily for us, when we create a push channel in transaction SAPC, SAP generates a class skeleton with 4 methods:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Footnotes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"id":"footnote-1"},"children":[{"type":"text","value":"\n1. Note that unfortunately the SAP Web IDE does not yet support websockets, that is, without network wizardry. I haven't managed to get it to work. I've left  long ago a message with the person who was the lead on Cloud Connector asking if websocket (`ws` protocol) would eventually something to be supported, but haven't heard anything.\n"}]}],"data":{"quirksMode":false}},"frontmatter":{"title":"ABAP Push and Message Channels","date":"January 12, 2018","draft":true,"starID":50,"postType":"dev"}}},"pageContext":{"slug":"/abap-push-and-message-channels/","prev":{"fields":{"slug":"/a-detailed-tutorial-shopify-storefront-apireact-redux/"},"frontmatter":{"date":"07 November, 2018","title":"A Detailed Tutorial - Shopify's Storefront API + React + Redux","draft":false,"starID":30,"postType":"dev","link":"https://chrisfrew.in/a-detailed-tutorial-shopify-storefront-apireact-redux/","relativeLink":"/a-detailed-tutorial-shopify-storefront-apireact-redux/"}},"next":{"fields":{"slug":"/colors-for-sap-web-ide/"},"frontmatter":{"date":"11 January, 2018","title":"Colors For SAP Web IDE!","draft":false,"starID":11,"postType":"dev","link":"https://chrisfrew.in/colors-for-sap-web-ide/","relativeLink":"/colors-for-sap-web-ide/"}}}}